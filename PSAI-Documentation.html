<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PSAI Module Documentation</title>
    <style>
        /* AI: CSS styles for formatting the documentation */
        body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; max-width: 800px; margin: 0 auto; padding: 20px; }
        h1, h2, h3 { color: #2c3e50; }
        h1 { border-bottom: 2px solid #2c3e50; padding-bottom: 10px; }
        h2 { border-bottom: 1px solid #bdc3c7; padding-bottom: 5px; }
        code { background-color: #f8f8f8; padding: 2px 4px; border-radius: 4px; }
        pre { background-color: #f8f8f8; padding: 10px; border-radius: 4px; overflow-x: auto; }
        table { border-collapse: collapse; width: 100%; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
        .toc { background-color: #f8f8f8; padding: 20px; border-radius: 4px; margin-bottom: 20px; }
        .toc table { width: 100%; }
        .toc a { text-decoration: none; color: #3498db; }
        .toc a:hover { text-decoration: underline; }
        .page { page-break-after: always; }
        .page:last-child { page-break-after: avoid; }
        .toc-page-number { text-align: right; }
        @media print {
            .page { page-break-after: always; }
            .page:last-child { page-break-after: avoid; }
        }
    </style>
</head>
<body>

<h1>PSAI Module Documentation</h1>

<p><strong>Version:</strong> 0.2.9</p>
<p><strong>Description:</strong> PSAI brings OpenAI ChatGPT to PowerShell, leveraging advanced AI capabilities in your PowerShell scripts for dynamic, intelligent automation and data processing</p>

<div class="toc">
<h2>Table of Contents</h2>
<table>
<tr><th>Command</th><th>Page</th></tr><tr><td><a href='#AddOAIToolsToList'>Add-OAIToolsToList</a></td><td class='toc-page-number'>1</td></tr>
<tr><td><a href='#AddOAIVectorStore'>Add-OAIVectorStore</a></td><td class='toc-page-number'>2</td></tr>
<tr><td><a href='#ClearOAIAllItems'>Clear-OAIAllItems</a></td><td class='toc-page-number'>3</td></tr>
<tr><td><a href='#ClearOAIAssistants'>Clear-OAIAssistants</a></td><td class='toc-page-number'>4</td></tr>
<tr><td><a href='#ClearOAIFiles'>Clear-OAIFiles</a></td><td class='toc-page-number'>5</td></tr>
<tr><td><a href='#ConvertFromFunctionDefinition'>ConvertFrom-FunctionDefinition</a></td><td class='toc-page-number'>6</td></tr>
<tr><td><a href='#ConvertFromGPTMarkdownTable'>ConvertFrom-GPTMarkdownTable</a></td><td class='toc-page-number'>7</td></tr>
<tr><td><a href='#ConvertFromOAIAssistant'>ConvertFrom-OAIAssistant</a></td><td class='toc-page-number'>8</td></tr>
<tr><td><a href='#ConvertFromUnixTimestamp'>ConvertFrom-UnixTimestamp</a></td><td class='toc-page-number'>9</td></tr>
<tr><td><a href='#ConvertToOAIAssistant'>ConvertTo-OAIAssistant</a></td><td class='toc-page-number'>10</td></tr>
<tr><td><a href='#ConvertToOpenAIFunctionSpec'>ConvertTo-OpenAIFunctionSpec</a></td><td class='toc-page-number'>11</td></tr>
<tr><td><a href='#ConvertToOpenAIFunctionSpecDataType'>ConvertTo-OpenAIFunctionSpecDataType</a></td><td class='toc-page-number'>12</td></tr>
<tr><td><a href='#ConvertToToolFormat'>ConvertTo-ToolFormat</a></td><td class='toc-page-number'>13</td></tr>
<tr><td><a href='#CopyOAIAssistant'>Copy-OAIAssistant</a></td><td class='toc-page-number'>14</td></tr>
<tr><td><a href='#DisableUnitTesting'>Disable-UnitTesting</a></td><td class='toc-page-number'>15</td></tr>
<tr><td><a href='#dumpJson'>dumpJson</a></td><td class='toc-page-number'>16</td></tr>
<tr><td><a href='#EnableAIShortCutKey'>Enable-AIShortCutKey</a></td><td class='toc-page-number'>17</td></tr>
<tr><td><a href='#EnableOAICodeInterpreter'>Enable-OAICodeInterpreter</a></td><td class='toc-page-number'>18</td></tr>
<tr><td><a href='#EnableOAIFileSearchTool'>Enable-OAIFileSearchTool</a></td><td class='toc-page-number'>19</td></tr>
<tr><td><a href='#EnableUnitTesting'>Enable-UnitTesting</a></td><td class='toc-page-number'>20</td></tr>
<tr><td><a href='#ExportOAIAssistant'>Export-OAIAssistant</a></td><td class='toc-page-number'>21</td></tr>
<tr><td><a href='#FormatOAIFunctionCall'>Format-OAIFunctionCall</a></td><td class='toc-page-number'>22</td></tr>
<tr><td><a href='#GetAzOAISecrets'>Get-AzOAISecrets</a></td><td class='toc-page-number'>23</td></tr>
<tr><td><a href='#GetFunctionDefinition'>Get-FunctionDefinition</a></td><td class='toc-page-number'>24</td></tr>
<tr><td><a href='#GetMultipartFormData'>Get-MultipartFormData</a></td><td class='toc-page-number'>25</td></tr>
<tr><td><a href='#GetOAIAssistant'>Get-OAIAssistant</a></td><td class='toc-page-number'>26</td></tr>
<tr><td><a href='#GetOAIAssistantItem'>Get-OAIAssistantItem</a></td><td class='toc-page-number'>27</td></tr>
<tr><td><a href='#GetOAIFile'>Get-OAIFile</a></td><td class='toc-page-number'>28</td></tr>
<tr><td><a href='#GetOAIFileContent'>Get-OAIFileContent</a></td><td class='toc-page-number'>29</td></tr>
<tr><td><a href='#GetOAIFileItem'>Get-OAIFileItem</a></td><td class='toc-page-number'>30</td></tr>
<tr><td><a href='#GetOAIFunctionCallSpec'>Get-OAIFunctionCallSpec</a></td><td class='toc-page-number'>31</td></tr>
<tr><td><a href='#GetOAIImageGeneration'>Get-OAIImageGeneration</a></td><td class='toc-page-number'>32</td></tr>
<tr><td><a href='#GetOAIMessage'>Get-OAIMessage</a></td><td class='toc-page-number'>33</td></tr>
<tr><td><a href='#GetOAIMessageItem'>Get-OAIMessageItem</a></td><td class='toc-page-number'>34</td></tr>
<tr><td><a href='#GetOAIProvider'>Get-OAIProvider</a></td><td class='toc-page-number'>35</td></tr>
<tr><td><a href='#GetOAIRun'>Get-OAIRun</a></td><td class='toc-page-number'>36</td></tr>
<tr><td><a href='#GetOAIRunItem'>Get-OAIRunItem</a></td><td class='toc-page-number'>37</td></tr>
<tr><td><a href='#GetOAIRunStep'>Get-OAIRunStep</a></td><td class='toc-page-number'>38</td></tr>
<tr><td><a href='#GetOAIRunStepItem'>Get-OAIRunStepItem</a></td><td class='toc-page-number'>39</td></tr>
<tr><td><a href='#GetOAIThread'>Get-OAIThread</a></td><td class='toc-page-number'>40</td></tr>
<tr><td><a href='#GetOAIThreadItem'>Get-OAIThreadItem</a></td><td class='toc-page-number'>41</td></tr>
<tr><td><a href='#GetOAIVectorStore'>Get-OAIVectorStore</a></td><td class='toc-page-number'>42</td></tr>
<tr><td><a href='#GetOAIVectorStoreFile'>Get-OAIVectorStoreFile</a></td><td class='toc-page-number'>43</td></tr>
<tr><td><a href='#GetOAIVectorStoreFileBatch'>Get-OAIVectorStoreFileBatch</a></td><td class='toc-page-number'>44</td></tr>
<tr><td><a href='#GetOAIVectorStoreFileItem'>Get-OAIVectorStoreFileItem</a></td><td class='toc-page-number'>45</td></tr>
<tr><td><a href='#GetOAIVectorStoreFilesInBatch'>Get-OAIVectorStoreFilesInBatch</a></td><td class='toc-page-number'>46</td></tr>
<tr><td><a href='#GetOAIVectorStoreItem'>Get-OAIVectorStoreItem</a></td><td class='toc-page-number'>47</td></tr>
<tr><td><a href='#GetOpenAISpecDescriptions'>Get-OpenAISpecDescriptions</a></td><td class='toc-page-number'>48</td></tr>
<tr><td><a href='#GetUnitTestingData'>Get-UnitTestingData</a></td><td class='toc-page-number'>49</td></tr>
<tr><td><a href='#GetUnitTestingStatus'>Get-UnitTestingStatus</a></td><td class='toc-page-number'>50</td></tr>
<tr><td><a href='#ImportOAIAssistant'>Import-OAIAssistant</a></td><td class='toc-page-number'>51</td></tr>
<tr><td><a href='#InvokeAIExplain'>Invoke-AIExplain</a></td><td class='toc-page-number'>52</td></tr>
<tr><td><a href='#InvokeAIPrompt'>Invoke-AIPrompt</a></td><td class='toc-page-number'>53</td></tr>
<tr><td><a href='#InvokeFilesToPrompt'>Invoke-FilesToPrompt</a></td><td class='toc-page-number'>54</td></tr>
<tr><td><a href='#InvokeOAIBeta'>Invoke-OAIBeta</a></td><td class='toc-page-number'>55</td></tr>
<tr><td><a href='#InvokeOAIChat'>Invoke-OAIChat</a></td><td class='toc-page-number'>56</td></tr>
<tr><td><a href='#InvokeOAIChatCompletion'>Invoke-OAIChatCompletion</a></td><td class='toc-page-number'>57</td></tr>
<tr><td><a href='#InvokeOAIUploadFile'>Invoke-OAIUploadFile</a></td><td class='toc-page-number'>58</td></tr>
<tr><td><a href='#InvokeQuickChat'>Invoke-QuickChat</a></td><td class='toc-page-number'>59</td></tr>
<tr><td><a href='#InvokeSimpleQuestion'>Invoke-SimpleQuestion</a></td><td class='toc-page-number'>60</td></tr>
<tr><td><a href='#NewChatRequestAssistantMessage'>New-ChatRequestAssistantMessage</a></td><td class='toc-page-number'>61</td></tr>
<tr><td><a href='#NewChatRequestSystemMessage'>New-ChatRequestSystemMessage</a></td><td class='toc-page-number'>62</td></tr>
<tr><td><a href='#NewChatRequestToolMessage'>New-ChatRequestToolMessage</a></td><td class='toc-page-number'>63</td></tr>
<tr><td><a href='#NewChatRequestUserMessage'>New-ChatRequestUserMessage</a></td><td class='toc-page-number'>64</td></tr>
<tr><td><a href='#NewOAIAssistant'>New-OAIAssistant</a></td><td class='toc-page-number'>65</td></tr>
<tr><td><a href='#NewOAIAssistantWithVectorStore'>New-OAIAssistantWithVectorStore</a></td><td class='toc-page-number'>66</td></tr>
<tr><td><a href='#NewOAIChatMessage'>New-OAIChatMessage</a></td><td class='toc-page-number'>67</td></tr>
<tr><td><a href='#NewOAIMessage'>New-OAIMessage</a></td><td class='toc-page-number'>68</td></tr>
<tr><td><a href='#NewOAIRun'>New-OAIRun</a></td><td class='toc-page-number'>69</td></tr>
<tr><td><a href='#NewOAIThread'>New-OAIThread</a></td><td class='toc-page-number'>70</td></tr>
<tr><td><a href='#NewOAIThreadAndRun'>New-OAIThreadAndRun</a></td><td class='toc-page-number'>71</td></tr>
<tr><td><a href='#NewOAIThreadQuery'>New-OAIThreadQuery</a></td><td class='toc-page-number'>72</td></tr>
<tr><td><a href='#NewOAIVectorStore'>New-OAIVectorStore</a></td><td class='toc-page-number'>73</td></tr>
<tr><td><a href='#NewOAIVectorStoreFile'>New-OAIVectorStoreFile</a></td><td class='toc-page-number'>74</td></tr>
<tr><td><a href='#NewOAIVectorStoreFileBatch'>New-OAIVectorStoreFileBatch</a></td><td class='toc-page-number'>75</td></tr>
<tr><td><a href='#OutOAIMessages'>Out-OAIMessages</a></td><td class='toc-page-number'>76</td></tr>
<tr><td><a href='#RemoveOAIAssistant'>Remove-OAIAssistant</a></td><td class='toc-page-number'>77</td></tr>
<tr><td><a href='#RemoveOAIFile'>Remove-OAIFile</a></td><td class='toc-page-number'>78</td></tr>
<tr><td><a href='#RemoveOAIMessage'>Remove-OAIMessage</a></td><td class='toc-page-number'>79</td></tr>
<tr><td><a href='#RemoveOAIThread'>Remove-OAIThread</a></td><td class='toc-page-number'>80</td></tr>
<tr><td><a href='#RemoveOAIVectorStore'>Remove-OAIVectorStore</a></td><td class='toc-page-number'>81</td></tr>
<tr><td><a href='#RemoveOAIVectorStoreFile'>Remove-OAIVectorStoreFile</a></td><td class='toc-page-number'>82</td></tr>
<tr><td><a href='#ResetAIShortCutKey'>Reset-AIShortCutKey</a></td><td class='toc-page-number'>83</td></tr>
<tr><td><a href='#ResetOAIProvider'>Reset-OAIProvider</a></td><td class='toc-page-number'>84</td></tr>
<tr><td><a href='#SetAzOAISecrets'>Set-AzOAISecrets</a></td><td class='toc-page-number'>85</td></tr>
<tr><td><a href='#SetOAIProvider'>Set-OAIProvider</a></td><td class='toc-page-number'>86</td></tr>
<tr><td><a href='#ShowOAIAPIReferenceWebPage'>Show-OAIAPIReferenceWebPage</a></td><td class='toc-page-number'>87</td></tr>
<tr><td><a href='#ShowOAIAssistantWebPage'>Show-OAIAssistantWebPage</a></td><td class='toc-page-number'>88</td></tr>
<tr><td><a href='#ShowOAIBilling'>Show-OAIBilling</a></td><td class='toc-page-number'>89</td></tr>
<tr><td><a href='#ShowOAIPlaygroundWebPage'>Show-OAIPlaygroundWebPage</a></td><td class='toc-page-number'>90</td></tr>
<tr><td><a href='#ShowOAIVectorStoreWebPage'>Show-OAIVectorStoreWebPage</a></td><td class='toc-page-number'>91</td></tr>
<tr><td><a href='#StopOAIRun'>Stop-OAIRun</a></td><td class='toc-page-number'>92</td></tr>
<tr><td><a href='#StopOAIVectorStoreFileBatch'>Stop-OAIVectorStoreFileBatch</a></td><td class='toc-page-number'>93</td></tr>
<tr><td><a href='#SubmitOAIMessage'>Submit-OAIMessage</a></td><td class='toc-page-number'>94</td></tr>
<tr><td><a href='#SubmitOAIToolOutputs'>Submit-OAIToolOutputs</a></td><td class='toc-page-number'>95</td></tr>
<tr><td><a href='#TestJsonReplacement'>Test-JsonReplacement</a></td><td class='toc-page-number'>96</td></tr>
<tr><td><a href='#TestLLMModel'>Test-LLMModel</a></td><td class='toc-page-number'>97</td></tr>
<tr><td><a href='#TestOAIAssistantId'>Test-OAIAssistantId</a></td><td class='toc-page-number'>98</td></tr>
<tr><td><a href='#UpdateOAIAssistant'>Update-OAIAssistant</a></td><td class='toc-page-number'>99</td></tr>
<tr><td><a href='#UpdateOAIMessage'>Update-OAIMessage</a></td><td class='toc-page-number'>100</td></tr>
<tr><td><a href='#UpdateOAIRun'>Update-OAIRun</a></td><td class='toc-page-number'>101</td></tr>
<tr><td><a href='#UpdateOAIThread'>Update-OAIThread</a></td><td class='toc-page-number'>102</td></tr>
<tr><td><a href='#UpdateOAIVectorStore'>Update-OAIVectorStore</a></td><td class='toc-page-number'>103</td></tr>
<tr><td><a href='#WaitOAIOnRun'>Wait-OAIOnRun</a></td><td class='toc-page-number'>104</td></tr>
</table>
</div>

<div class="content"><div class="page" id="AddOAIToolsToList">
<h2>Add-OAIToolsToList</h2>
<p><strong>Page:</strong> 1</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Adds tools and functions to a list for use with OpenAI Assistants.</p>
<h3>Description</h3>
<p>The Add-OAIToolsToList function is used to add tools and functions to a list, which can be used with OpenAI Assistants. It takes in parameters for the tools, function JSON, and a hashtable representing the body of the request. The function then constructs a list of tools and functions based on the provided parameters and updates the 'tools' property of the body hashtable.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>Tools</code></td><td>System.Object</td><td>An optional array of strings representing the tools to be added to the list.</td></tr>
<tr><td><code>FunctionJson</code></td><td>System.Object</td><td>An optional array of function JSON objects representing the functions to be added to the list.</td></tr>
<tr><td><code>Body</code></td><td>System.Collections.Hashtable</td><td>A mandatory hashtable representing the body of the request.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Add-OAIToolsToList -Tools 'spellcheck' -FunctionJson @('{"type": "function", "function": "function_json"}') -Body $body
Adds the 'spellcheck' tool and a function JSON object to the list of tools in the body hashtable.</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param(
        $Tools,
        $FunctionJson,
        [Parameter(Mandatory)]
        [Hashtable]$Body
    )

    $toolList = @()
    
    if ($Tools) {
        foreach ($tool in $Tools) {
            $toolList += @{ type = $tool }
        }
    }
    
    if ($FunctionJson) {
        # {"type": "function", "function": function_json},

        foreach ($function in $FunctionJson) {
            $toolList += @{
                type     = 'function'
                function = $function | ConvertFrom-Json -Depth 15 -AsHashtable
            }
        }
    }
    
    if ($toolList.Count -gt 0) {
        $Body['tools'] = $toolList
    }
</code></pre>
</div>
<div class="page" id="AddOAIVectorStore">
<h2>Add-OAIVectorStore</h2>
<p><strong>Page:</strong> 2</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Uploads one or more files and creates a vector store.</p>
<h3>Description</h3>
<p>The Add-OAIVectorStore function is a simple workflow using Invoke-OAIUploadFile and New-OAIVectorStore to upload files to OpenAI and create a vector store.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>Path</code></td><td>System.Object</td><td>Specifies the path where the files to be uploaded are located.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Add-OAIVectorStore -Path "C:\Files"</code></pre>
<p>This example uploads all the files located in the "C:\Files" directory to OAI and creates a vector store.    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param(
        [Parameter(Mandatory)]
        $Path
    )

    $timeStamp = Get-Date -Format "yyyyMMddHHmmss" 
    Write-Host "Uploading files in $Path to OAI..." -ForegroundColor Cyan
    $files = Get-ChildItem $Path | Invoke-OAIUploadFile

    Write-Host "Creating vector store..." -ForegroundColor Cyan
    New-OAIVectorStore -Name "vs$($timeStamp)" -FileIds $files.id
</code></pre>
</div>
<div class="page" id="ClearOAIAllItems">
<h2>Clear-OAIAllItems</h2>
<p><strong>Page:</strong> 3</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Clears all items in the OAI (OpenAI) system.</p>
<h3>Description</h3>
<p>The Clear-OAIAllItems function clears all items in the OAI (OpenAI) system by calling the Clear-OAIAssistants and Clear-OAIFiles functions.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Clear-OAIAllItems
Clears all items in the OAI (OpenAI) system.</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param()
    
    Clear-OAIAssistants
    Clear-OAIFiles
</code></pre>
</div>
<div class="page" id="ClearOAIAssistants">
<h2>Clear-OAIAssistants</h2>
<p><strong>Page:</strong> 4</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Clears all OAI assistants.</p>
<h3>Description</h3>
<p>This function clears all OAI (OpenAI) assistants by removing them.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Clear-OAIAssistants
Clears all OAI assistants.</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param()
    
    Get-OAIAssistant | Remove-OAIAssistant 
</code></pre>
</div>
<div class="page" id="ClearOAIFiles">
<h2>Clear-OAIFiles</h2>
<p><strong>Page:</strong> 5</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Clears all files generated by the Get-OAIFile cmdlet.</p>
<h3>Description</h3>
<p>The Clear-OAIFiles function is used to remove all files that were generated by the Get-OAIFile cmdlet. This function does not take any parameters.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Clear-OAIFiles
Removes all files generated by the Get-OAIFile cmdlet.</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param()
    
    Get-OAIFile | Remove-OAIFile
</code></pre>
</div>
<div class="page" id="ConvertFromFunctionDefinition">
<h2>ConvertFrom-FunctionDefinition</h2>
<p><strong>Page:</strong> 6</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Converts a PowerShell function definition to an OpenAI function specification.</p>
<h3>Description</h3>
<p>This function takes a PowerShell function definition and converts it to an OpenAI function specification.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>FunctionInfo</code></td><td>System.Management.Automation.CommandInfo[]</td><td>An array of CommandInfo objects representing the functions to convert.</td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>ConvertFrom-FunctionDefinition -FunctionInfo (Get-Command Get-ChildItem)</code></pre>
<p>This example converts the Get-ChildItem function to an OpenAI function specification.    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    <#
    .SYNOPSIS
    Converts a PowerShell function definition to an OpenAI function specification.

    .DESCRIPTION
    This function takes a PowerShell function definition and converts it to an OpenAI function specification.

    .PARAMETER FunctionInfo
    An array of CommandInfo objects representing the functions to convert.

    .EXAMPLE
    PS C:\> ConvertFrom-FunctionDefinition -FunctionInfo (Get-Command Get-ChildItem)

    This example converts the Get-ChildItem function to an OpenAI function specification.

    #>
    param (
        [System.Management.Automation.CommandInfo[]]$FunctionInfo
    )
    
    Get-FunctionDefinition $FunctionInfo | ForEach-Object {
        ConvertTo-OpenAIFunctionSpec -targetCode $_ -Raw
    }
</code></pre>
</div>
<div class="page" id="ConvertFromGPTMarkdownTable">
<h2>ConvertFrom-GPTMarkdownTable</h2>
<p><strong>Page:</strong> 7</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Converts a markdown table to a PowerShell object.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>markdown</code></td><td>System.Object</td><td>The markdown table to convert.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>ConvertFrom-GPTMarkdownTable -Markdown @'
| Name | Value |
| ---- | ----- |
| foo  | bar   |
| baz  | qux   |
'@</code></pre>
<p>    </p>
<pre><code class='language-powershell'>ai 'markdown table syntax' | ConvertFrom-GPTMarkdownTable</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    <#
    .SYNOPSIS
        Converts a markdown table to a PowerShell object.

    .PARAMETER Markdown
        The markdown table to convert.
    .EXAMPLE
        ConvertFrom-GPTMarkdownTable -Markdown @'
        | Name | Value |
        | ---- | ----- |
        | foo  | bar   |
        | baz  | qux   |
        '@

    .EXAMPLE
        ai 'markdown table syntax' | ConvertFrom-GPTMarkdownTable        
    #>
    param(
        [Parameter(ValueFromPipeline)]
        $markdown
    )

    End {
        
        $lines = $markdown.Trim() -split "`n"

        $data = foreach ($line in $lines) {
            if ($line -match '[A-Za-z0-9]') {
                $line.Trim() -replace "^\|", "" -replace "\| ", "|" -replace " \|", "|"
            }
        }

        $data | ConvertFrom-Csv -Delimiter '|'
    }
</code></pre>
</div>
<div class="page" id="ConvertFromOAIAssistant">
<h2>ConvertFrom-OAIAssistant</h2>
<p><strong>Page:</strong> 8</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Converts an AI assistant object to Json.</p>
<h3>Description</h3>
<p>The ConvertFrom-OAIAssistant function takes an AI assistant object as input and converts it to Json. It removes certain properties from the object. This allows you to save and resotre the assisant correctly</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>Assistant</code></td><td>System.Object</td><td>The AI assistant object to be converted.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>$assistant = New-OAIAssistant 
ConvertFrom-OAIAssistant -Assistant $assistant</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param(
        [Parameter(Mandatory)]
        $Assistant
    )

    $assistantProperties = $assistant | ConvertTo-Json -Depth 10 | ConvertFrom-Json -Depth 10 -AsHashtable

    # remove these properties
    $assistantProperties.remove("id")
    $assistantProperties.remove("object")
    $assistantProperties.remove("created_at")

    $assistantProperties | ConvertTo-Json -Depth 10 
</code></pre>
</div>
<div class="page" id="ConvertFromUnixTimestamp">
<h2>ConvertFrom-UnixTimestamp</h2>
<p><strong>Page:</strong> 9</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Converts a Unix timestamp to a DateTime object.</p>
<h3>Description</h3>
<p>The ConvertFrom-UnixTimestamp function takes a Unix timestamp as input and converts it to a DateTime object. 
A Unix timestamp represents the number of seconds that have elapsed since January 1, 1970, 00:00:00 UTC.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>UnixTimestamp</code></td><td>System.Int32</td><td>The Unix timestamp to convert.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>ConvertFrom-UnixTimestamp -UnixTimestamp 1625097600</code></pre>
<p>This example converts the Unix timestamp 1625097600 to a DateTime object.    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    param(
        [Parameter(Mandatory, ValueFromPipeline)]
        [int]$UnixTimestamp
    )
    process {
        (Get-Date "1970-01-01").AddSeconds($UnixTimestamp)
    }
</code></pre>
</div>
<div class="page" id="ConvertToOAIAssistant">
<h2>ConvertTo-OAIAssistant</h2>
<p><strong>Page:</strong> 10</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Converts the Assistant configuration to an OAIAssistant object.</p>
<h3>Description</h3>
<p>The ConvertTo-OAIAssistant function takes an Assistant configuration as input and converts it to an OAIAssistant object. The Assistant configuration can be provided as a JSON file path or as a JSON string.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>AssistantConfig</code></td><td>System.Object</td><td>The Assistant configuration. It can be provided as a file path to a JSON file or as a JSON string.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>ConvertTo-OAIAssistant -AssistantConfig "C:\AssistantConfig.json"</code></pre>
<p>This example converts the Assistant configuration stored in the "C:\AssistantConfig.json" file to an OAIAssistant object.    </p>
<pre><code class='language-powershell'>ConvertTo-OAIAssistant -AssistantConfig '{"name": "MyAssistant"}'</code></pre>
<p>This example converts the Assistant configuration provided as a JSON string to an OAIAssistant object.    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param(
        $AssistantConfig
    )

    if (Test-JsonReplacement -Json $AssistantConfig) {
        $assistantParams = $AssistantConfig | ConvertFrom-Json -Depth 10 -AsHashtable        
    }
    else {
        if (Test-Path $AssistantConfig) {
            $assistantParams = Get-Content -Raw $AssistantConfig | ConvertFrom-Json -Depth 10 -AsHashtable        
        }
        else {
            Write-Error "$AssistantConfig not found"
            return
        }
    }
    
    New-OAIAssistant @assistantParams
</code></pre>
</div>
<div class="page" id="ConvertToOpenAIFunctionSpec">
<h2>ConvertTo-OpenAIFunctionSpec</h2>
<p><strong>Page:</strong> 11</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Converts a PowerShell function to an OpenAI function specification.</p>
<h3>Description</h3>
<p>The ConvertTo-OpenAIFunctionSpec function takes a PowerShell function as input and returns an OpenAI function specification. The function specification includes the function name, description, and parameter information.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>targetCode</code></td><td>System.Object</td><td>The PowerShell function to convert to an OpenAI function specification.</td></tr>
<tr><td><code>Strict</code></td><td>System.Management.Automation.SwitchParameter</td><td>When Structured Outputs are enabled, model outputs will match the supplied tool definition.</td></tr>
<tr><td><code>Compress</code></td><td>System.Management.Automation.SwitchParameter</td><td>Indicates whether to compress the output JSON.</td></tr>
<tr><td><code>Raw</code></td><td>System.Management.Automation.SwitchParameter</td><td>Indicates whether to return the raw function specification object instead of JSON.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>$functionCode = Get-Content -Path "C:\MyFunction.ps1" -Raw
PS C:\> ConvertTo-OpenAIFunctionSpec -targetCode $functionCode -Compress</code></pre>
<p>This example reads the contents of a PowerShell function file, converts the function to an OpenAI function specification, and returns the specification as compressed JSON.    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    <#
        .SYNOPSIS
        Converts a PowerShell function to an OpenAI function specification.

        .DESCRIPTION
        The ConvertTo-OpenAIFunctionSpec function takes a PowerShell function as input and returns an OpenAI function specification. The function specification includes the function name, description, and parameter information.

        .PARAMETER targetCode
        The PowerShell function to convert to an OpenAI function specification.

        .PARAMETER Strict
        When Structured Outputs are enabled, model outputs will match the supplied tool definition.

        .PARAMETER Compress
        Indicates whether to compress the output JSON.

        .PARAMETER Raw
        Indicates whether to return the raw function specification object instead of JSON.

        .EXAMPLE
        PS C:\> $functionCode = Get-Content -Path "C:\MyFunction.ps1" -Raw
        PS C:\> ConvertTo-OpenAIFunctionSpec -targetCode $functionCode -Compress

        This example reads the contents of a PowerShell function file, converts the function to an OpenAI function specification, and returns the specification as compressed JSON.
    #>
    [CmdletBinding()]
    param(
        $targetCode,
        [Switch]$Strict,
        [Switch]$Compress,
        [Switch]$Raw
    )
    
    $ast = [System.Management.Automation.Language.Parser]::ParseInput($targetCode, [ref]$null, [ref]$null)
    $functions = $ast.FindAll({ $args[0] -is [System.Management.Automation.Language.FunctionDefinitionAst] }, $false)

    $functionSpec = @()
    foreach ($function in $functions) {
        $descriptions = Get-OpenAISpecDescriptions $function.Body.extent.text

        if ($null -eq $descriptions.FunctionDescription) {
            $targetDescription = 'not supplied'
        }
        else {
            $targetDescription = $descriptions.FunctionDescription
        }

        $newFunctionSpec = [ordered]@{
            name        = $function.Name
            description = $targetDescription         
            parameters  = [ordered]@{
                type       = 'object'
                properties = [ordered]@{}
                required   = @()
            }
        }

        if($Strict) {
            $newFunctionSpec["strict"] = $true
            $newFunctionSpec["parameters"]["additionalProperties"] = $false
        }

        $functionSpec += $newFunctionSpec
        $properties = $functionSpec[-1].parameters.properties
        $parameters = $function.Body.ParamBlock.Parameters
        foreach ($parameter in $parameters) {
            $parameterName = $parameter.Name.VariablePath.UserPath
            $typeName = $parameter.StaticType.Name.ToLower()
            if ($parameter.StaticType.BaseType.Name -eq 'Array') {
                $typeName = 'array'                
            }

            if ($null -eq $descriptions.ParameterDescription.$parameterName) {
                $targetDescription = 'not supplied'
            }
            else {
                $targetDescription = $descriptions.ParameterDescription.$parameterName
            }

            $properties[$parameterName] = [ordered]@{            
                type        = ConvertTo-OpenAIFunctionSpecDataType $typeName
                description = $targetDescription
            }
        
            $enum = ($parameter.Attributes | Where-Object { $_.typeName.name -eq 'ValidateSet' }).PositionalArguments.Value

            if ($enum) {
                $properties[$parameterName].enum = $enum
            }
        
            $functionSpec[-1].parameters.required += $parameterName
        }
    }
    
    if ($Raw) {
        return $functionSpec
    }

    $functionSpec | ConvertTo-Json -Depth 10 -Compress:$Compress
</code></pre>
</div>
<div class="page" id="ConvertToOpenAIFunctionSpecDataType">
<h2>ConvertTo-OpenAIFunctionSpecDataType</h2>
<p><strong>Page:</strong> 12</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Converts a .NET data type to an OpenAI Function Spec data type.</p>
<h3>Description</h3>
<p>This function takes a .NET data type as input and returns the corresponding OpenAI Function Spec data type.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>targetType</code></td><td>System.Object</td><td>The .NET data type to convert.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>ConvertTo-OpenAIFunctionSpecDataType -targetType 'int32'
Returns 'number'.</code></pre>
<p>    </p>
<pre><code class='language-powershell'>ConvertTo-OpenAIFunctionSpecDataType -targetType 'switchparameter'
Returns 'boolean'.</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    <#
        .SYNOPSIS
        Converts a .NET data type to an OpenAI Function Spec data type.

        .DESCRIPTION
        This function takes a .NET data type as input and returns the corresponding OpenAI Function Spec data type.

        .PARAMETER targetType
        The .NET data type to convert.

        .EXAMPLE
        ConvertTo-OpenAIFunctionSpecDataType -targetType 'int32'
        Returns 'number'.

        .EXAMPLE
        ConvertTo-OpenAIFunctionSpecDataType -targetType 'switchparameter'
        Returns 'boolean'.
    #>

    [CmdletBinding()]
    param($targetType)

    switch ($targetType) {
        { $_ -match 'int32|decimal|float|single|int' } { return 'number' }
        { $_ -match 'switchparameter|bool|boolean'} { return 'boolean' }
        default { return $targetType }
    }
</code></pre>
</div>
<div class="page" id="ConvertToToolFormat">
<h2>ConvertTo-ToolFormat</h2>
<p><strong>Page:</strong> 13</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Converts an array of functions into a tool format.</p>
<h3>Description</h3>
<p>The ConvertTo-ToolFormat function takes an array of functions and converts them into a tool format. Each function in the array is transformed into a hashtable with a 'type' key set to 'function' and a 'function' key set to the original function.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>functions</code></td><td>System.Collections.Hashtable[]</td><td>An array of hashtables representing functions.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>$functions = @(
    @{
        Name = 'Get-User'
        Description = 'Retrieves user information'
        Parameters = @(
            @{
                Name = 'Username'
                Type = 'String'
                Description = 'The username of the user'
            }
        )
    }
)</code></pre>
<p>ConvertTo-ToolFormat -functions $functions    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param(
        [hashtable[]]$functions
    )

    foreach ($function in $functions) {
        @{
            type     = 'function'
            function = $function
        }
    }
</code></pre>
</div>
<div class="page" id="CopyOAIAssistant">
<h2>Copy-OAIAssistant</h2>
<p><strong>Page:</strong> 14</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Copies an OpenAI Assistant to create a new Assistant with optional name change.</p>
<h3>Description</h3>
<p>The Copy-OAIAssistant function copies an OpenAI Assistant identified by AssistantId and creates a new Assistant with optional name change.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>AssistantId</code></td><td>System.Object</td><td>Specifies the ID of the OpenAI Assistant to be copied.</td></tr>
<tr><td><code>NewName</code></td><td>System.Object</td><td>Specifies the new name for the copied Assistant. If not provided, the copied Assistant will retain the same name as the original Assistant.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Copy-OAIAssistant -AssistantId "assistant-12345" -NewName "MyCopiedAssistant"
Copies the OpenAI Assistant with ID "assistant-12345" and creates a new Assistant with the name "MyCopiedAssistant".</code></pre>
<p>    </p>
<pre><code class='language-powershell'>Copy-OAIAssistant -AssistantId "assistant-67890"
Copies the OpenAI Assistant with ID "assistant-67890" and creates a new Assistant with the same name as the original Assistant.</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param(
        [Parameter(ValueFromPipelineByPropertyName)]
        [Alias("id")]
        $AssistantId,
        $NewName
    )

    Process {
        $srcAssistant = Get-OAIAssistantItem -AssistantId $AssistantId

        $params = ConvertTo-Json -Depth 10 $srcAssistant | ConvertFrom-Json -AsHashtable -Depth 10
                
        # remove these properties
        $params.remove("id")
        $params.remove("object")
        $params.remove("created_at") 

        $params["name"] = $params["name"] + " copy"
        if ($NewName) {
            $params["name"] = $NewName
        } 

        New-OAIAssistant @params
    }
</code></pre>
</div>
<div class="page" id="DisableUnitTesting">
<h2>Disable-UnitTesting</h2>
<p><strong>Page:</strong> 15</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Disables unit testing.</p>
<h3>Description</h3>
<p>The Disable-UnitTesting function sets the $EnableUnitTesting variable to $false, disabling unit testing.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Disable-UnitTesting</code></pre>
<p>This example disables unit testing by setting the $EnableUnitTesting variable to $false.    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    $script:EnableUnitTesting = $false
</code></pre>
</div>
<div class="page" id="dumpJson">
<h2>dumpJson</h2>
<p><strong>Page:</strong> 16</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Converts an object to JSON format.</p>
<h3>Description</h3>
<p>The `dumpJson` function converts an object to JSON format using the `ConvertTo-Json` cmdlet.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>obj</code></td><td>System.Object</td><td>Specifies the object to be converted to JSON format.</td></tr>
<tr><td><code>Depth</code></td><td>System.Object</td><td></td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>$obj = @{
    Name = "John Doe"
    Age = 30
    Email = "johndoe@example.com"
}
dumpJson $obj</code></pre>
<p>This example converts a hashtable object to JSON format.    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param(
        [Parameter(ValueFromPipeline)]
        [object]$obj,
        $Depth = 10
    )
    
    Process {
        ConvertTo-Json $obj -Depth $Depth
    }
</code></pre>
</div>
<div class="page" id="EnableAIShortCutKey">
<h2>Enable-AIShortCutKey</h2>
<p><strong>Page:</strong> 17</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> 
Enable-AIShortCutKey [[-ShortcutKey] <Object>]
</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>ShortcutKey</code></td><td>System.Object</td><td></td></tr>
</table>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    param(
        $ShortcutKey = $(
            # In Visual Studio Code, CTRL+G is "goto",
            if ((Get-Process -id $pid).Parent.ProcessName -eq 'code') {
                "ALT+G" # so we'll use ALT+G by default.
            }
            else {
                "CTRL+G" # If we're not running in code, use CTRL+G by default
            }
        )
    )

    Begin {
        $script:messages += New-ChatRequestSystemMessage @'
you are a helpful powershell expert. be concise, accurate, and friendly.
- you are in a powershell console
- no need for extra details
- no need for usage
- no need for examples
- just code, no fence blocks
- again just code, no fence blocks
'@
    }

    End {
        Set-PSReadLineKeyHandler -Key $ShortcutKey -BriefDescription OpenAICli -LongDescription "Calls Open AI on the current buffer" `
            -ScriptBlock {
            param($key, $arg)

            $line = $null
            $cursor = $null

            [Microsoft.PowerShell.PSConsoleReadLine]::GetBufferState([ref]$line, [ref]$cursor)

            $script:messages += New-ChatRequestUserMessage $line
            
            # $output = Get-GPT3Completion $prompt -max_tokens 256 
            # $output = $output -replace "`r", ""
            $response = Invoke-OAIChatCompletion -Messages $script:messages 

            $script:messages += $response.choices[0].message | ConvertTo-Json | ConvertFrom-Json -AsHashtable
            $output = $response.choices[0].message.content

            # check if output is not null
            if ($null -ne $output) {        
                foreach ($str in $output) {
                    if ($null -ne $str -and $str -ne "") {
                        [Microsoft.PowerShell.PSConsoleReadLine]::AddLine()
                        [Microsoft.PowerShell.PSConsoleReadLine]::Insert($str)
                    }
                }
            }
        }
    }
</code></pre>
</div>
<div class="page" id="EnableOAICodeInterpreter">
<h2>Enable-OAICodeInterpreter</h2>
<p><strong>Page:</strong> 18</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Enables the OAI code interpreter.</p>
<h3>Description</h3>
<p>The Enable-OAICodeInterpreter function enables the OAI (OpenAI) code interpreter.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Enable-OAICodeInterpreter</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param()
    
    @{'type' = 'code_interpreter' }
</code></pre>
</div>
<div class="page" id="EnableOAIFileSearchTool">
<h2>Enable-OAIFileSearchTool</h2>
<p><strong>Page:</strong> 19</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Enables the file searcch tool.</p>
<h3>Description</h3>
<p>The Enable-OAIFileSearchTool function enables the file search tool.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param()
    
    @{'type' = 'file_search' }
</code></pre>
</div>
<div class="page" id="EnableUnitTesting">
<h2>Enable-UnitTesting</h2>
<p><strong>Page:</strong> 20</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Enables unit testing.</p>
<h3>Description</h3>
<p>The Enable-UnitTesting function sets the $EnableUnitTesting variable to $true, enabling unit testing.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Enable-UnitTesting</code></pre>
<p>This example enables unit testing by setting the $EnableUnitTesting variable to $true.    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    $script:EnableUnitTesting = $true
</code></pre>
</div>
<div class="page" id="ExportOAIAssistant">
<h2>Export-OAIAssistant</h2>
<p><strong>Page:</strong> 21</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Exports an OpenAI Assistant to a JSON file.</p>
<h3>Description</h3>
<p>The Export-OAIAssistant function exports an OpenAI Assistant to a JSON file. It retrieves the assistant using the specified AssistantId and saves its properties to a JSON file at the specified Path.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>AssistantId</code></td><td>System.Object</td><td>The ID of the OpenAI Assistant to export.</td></tr>
<tr><td><code>Path</code></td><td>System.Object</td><td>The path where the exported JSON file will be saved.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Export-OAIAssistant -AssistantId "assistant-12345" -Path "C:\Exports\assistant-12345.json"
Exports the OpenAI Assistant with ID "assistant-12345" to a JSON file located at "C:\Exports\assistant-12345.json".</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param(
        [Parameter(ValueFromPipelineByPropertyName)]
        [Alias("id")]
        $AssistantId,
        $Path
    )

    Process {
        $assistant = Get-OAIAssistantItem -AssistantId $AssistantId

        $Path = $assistant.id + '-' + $assistant.name + ".json"
        Write-Host "Exporting to $Path"
        $assistantProperties = $assistant | ConvertTo-Json -Depth 10 | ConvertFrom-Json -Depth 10 -AsHashtable

        # remove these properties
        $assistantProperties.remove("id")
        $assistantProperties.remove("object")
        $assistantProperties.remove("created_at")
        
        $assistantProperties | ConvertTo-Json -Depth 10 | Out-File $Path
    }
</code></pre>
</div>
<div class="page" id="FormatOAIFunctionCall">
<h2>Format-OAIFunctionCall</h2>
<p><strong>Page:</strong> 22</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Formats the function call specification for the OAI (OpenAPI Initiative) generator.</p>
<h3>Description</h3>
<p>The Format-OAIFunctionCall function takes a function call specification and formats it for use with the OAI generator. It supports different input types such as string, hashtable, FunctionInfo, and array.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>FunctionSpec</code></td><td>System.Object</td><td>Specifies the function call specification to be formatted. It can be a string, hashtable, FunctionInfo object, or an array of function call specifications.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Format-OAIFunctionCall -FunctionSpec '{"name": "Get-User", "parameters": {"id": 123}}'
Formats the specified function call specification as a hashtable.</code></pre>
<p>    </p>
<pre><code class='language-powershell'>Format-OAIFunctionCall -FunctionSpec (Get-Command Get-User)
Formats the specified FunctionInfo object as a hashtable.</code></pre>
<p>    </p>
<pre><code class='language-powershell'>Format-OAIFunctionCall -FunctionSpec @('{"name": "Get-User", "parameters": {"id": 123}}', '{"name": "Set-User", "parameters": {"id": 456}}')
Formats each function call specification in the array as a hashtable.</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
  [CmdletBinding()]
  param(
    [Parameter(Mandatory)]
    $FunctionSpec
  )
  
  if ($FunctionSpec -is [string]) {
    if (Test-JsonReplacement $FunctionSpec -ErrorAction Ignore) {
      $r = $FunctionSpec | ConvertFrom-Json -Depth 10 -AsHashtable
    }
    else {
      throw "Invalid JSON string: $FunctionSpec"
    }
  }
  elseif ($FunctionSpec -is [hashtable]) {
    $r = $FunctionSpec  
  }
  elseif ($FunctionSpec -is [System.Management.Automation.FunctionInfo]) {
    $r = ConvertFrom-FunctionDefinition $FunctionSpec
  }
  elseif ($FunctionSpec -is [array]) {
    $result = foreach ($currentFunction in $FunctionSpec) {
      @{
        'type'   = 'function'
        function = ConvertFrom-FunctionDefinition $currentFunction
      } 
    }

    return $result
  }
  else {
    throw "Invalid FunctionSpec type: $($FunctionSpec.GetType().Name). Must be string, hashtable, or FunctionInfo."
  }
  
  @{
    'type'   = 'function'
    function = $r
  } 
</code></pre>
</div>
<div class="page" id="GetAzOAISecrets">
<h2>Get-AzOAISecrets</h2>
<p><strong>Page:</strong> 23</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Retrieves the AzOAI secrets.</p>
<h3>Description</h3>
<p>The Get-AzOAISecrets function retrieves the AzOAI secrets.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Get-AzOAISecrets
This example demonstrates how to use the Get-AzOAISecrets function to retrieve the AzOAI secrets.</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    $script:AzOAISecrets
</code></pre>
</div>
<div class="page" id="GetFunctionDefinition">
<h2>Get-FunctionDefinition</h2>
<p><strong>Page:</strong> 24</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Returns the definition of one or more PowerShell functions.</p>
<h3>Description</h3>
<p>The Get-FunctionDefinition function takes an array of CommandInfo objects representing PowerShell functions and returns their definitions as strings.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>FunctionInfo</code></td><td>System.Management.Automation.CommandInfo[]</td><td>An array of CommandInfo objects representing PowerShell functions.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Get-FunctionDefinition (Get-Command Get-FunctionDefinition)</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    <#
    .SYNOPSIS
    Returns the definition of one or more PowerShell functions.

    .DESCRIPTION
    The Get-FunctionDefinition function takes an array of CommandInfo objects representing PowerShell functions and returns their definitions as strings.

    .PARAMETER FunctionInfo
    An array of CommandInfo objects representing PowerShell functions.

    .EXAMPLE    
    Get-FunctionDefinition (Get-Command Get-FunctionDefinition)
    #>
    [CmdletBinding()]
    param (
        [System.Management.Automation.CommandInfo[]]$FunctionInfo
    )

    foreach ($functionTarget in $FunctionInfo) {
        "
function $($functionTarget.Name) {
$($functionTarget.Definition)
}"
    }
</code></pre>
</div>
<div class="page" id="GetMultipartFormData">
<h2>Get-MultipartFormData</h2>
<p><strong>Page:</strong> 25</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> 
Get-MultipartFormData [-FilePath] <Object> [-Purpose] <Object> [<CommonParameters>]
</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>FilePath</code></td><td>System.Object</td><td></td></tr>
<tr><td><code>Purpose</code></td><td>System.Object</td><td></td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    param (
        [Parameter(Mandatory)]
        $FilePath,
        [Parameter(Mandatory)]
        [ValidateSet('fine-tune', 'assistants', 'vision')]        
        $Purpose 
    )

    $boundary = [System.Guid]::NewGuid().ToString()
    $LF = [System.Environment]::NewLine
    $encoding = [System.Text.Encoding]::UTF8
    $stream = [IO.MemoryStream]::new()

    # Write start boundary
    $bytes = $encoding.GetBytes("--$boundary$LF")
    $stream.Write($bytes, 0, $bytes.Length)

    # Write purpose part
    $bytes = $encoding.GetBytes("Content-Disposition: form-data; name=`"purpose`"$LF$LF$Purpose$LF")
    $stream.Write($bytes, 0, $bytes.Length)

    # Write separator boundary
    $bytes = $encoding.GetBytes("--$boundary$LF")
    $stream.Write($bytes, 0, $bytes.Length)

    $FileName = Split-Path -Leaf $FilePath
    # Write file part    
    $bytes = $encoding.GetBytes("Content-Disposition: form-data; name=`"file`"; filename=`"$FileName`"$LF")
    $stream.Write($bytes, 0, $bytes.Length)
    $bytes = $encoding.GetBytes("Content-Type: application/octet-stream$LF$LF")
    $stream.Write($bytes, 0, $bytes.Length)
    $fileBytes = [IO.File]::ReadAllBytes($FilePath)
    $stream.Write($fileBytes, 0, $fileBytes.Length)
    $bytes = $encoding.GetBytes($LF)
    $stream.Write($bytes, 0, $bytes.Length)

    # Write end boundary
    $bytes = $encoding.GetBytes("--$boundary--$LF")
    $stream.Write($bytes, 0, $bytes.Length)
    
    # Reset stream position to start
    $stream.Position = 0
    
    @{ 
        'Stream'      = $stream
        'ContentType' = "multipart/form-data; boundary=$boundary"
    }
</code></pre>
</div>
<div class="page" id="GetOAIAssistant">
<h2>Get-OAIAssistant</h2>
<p><strong>Page:</strong> 26</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Retrieves OpenAI assistants based on specified criteria.</p>
<h3>Description</h3>
<p>The Get-OAIAssistant function retrieves OpenAI assistants based on the specified criteria such as name, limit, order, after, before, and raw output.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>Name</code></td><td>System.Object</td><td>Specifies the name of the OpenAI assistant to retrieve. If not specified, all assistants will be returned.</td></tr>
<tr><td><code>Limit</code></td><td>System.Object</td><td>Specifies the maximum number of assistants to retrieve.</td></tr>
<tr><td><code>Order</code></td><td>System.Object</td><td>Specifies the order in which the assistants should be sorted. Valid values are 'asc' (ascending) and 'desc' (descending). The default value is 'desc'.</td></tr>
<tr><td><code>After</code></td><td>System.Object</td><td>Specifies the cursor for pagination. Only assistants created after this cursor will be returned.</td></tr>
<tr><td><code>Before</code></td><td>System.Object</td><td>Specifies the cursor for pagination. Only assistants created before this cursor will be returned.</td></tr>
<tr><td><code>Raw</code></td><td>System.Management.Automation.SwitchParameter</td><td>Switch parameter. If specified, the raw response from the API will be returned.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Get-OAIAssistant -Name "MyAssistant" -Limit 10 -Order 'asc'
Retrieves the first 10 OpenAI assistants with the name "MyAssistant" in ascending order.</code></pre>
<p>    </p>
<pre><code class='language-powershell'>Get-OAIAssistant -Limit 5 -After "cursor123"
Retrieves the next 5 OpenAI assistants created after the cursor "cursor123".</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param(
        $Name,
        $Limit,
        [ValidateSet('asc', 'desc')]
        $Order,
        $After,
        $Before,        
        [Switch]$Raw
    )

    $url = $baseUrl + "/assistants"
    $Method = 'Get'

    $urlParams = @()
    if ($limit) {
        $urlParams += "limit=$limit"
    }
    if ($order) {
        $urlParams += "order=$order"
    }
    if ($after) {
        $urlParams += "after=$after"
    }
    if ($before) {
        $urlParams += "before=$before"
    }

    if ($urlParams.Count -gt 0) {
        $urlParams = "?" + ($urlParams -join '&')
        $url = $url + $urlParams
    }

    $response = Invoke-OAIBeta -Uri $url -Method $Method
    
    if ($Raw) {
        return $response
    }
    else {

        if (!$Name) {
            $Name = '*'
        }

        $properties = @('Id', 'Name', 'Instructions', 'Model', 'Tools')
        $response.data | Where-Object { $_.name -like $Name } | Select-Object $properties
    }
</code></pre>
</div>
<div class="page" id="GetOAIAssistantItem">
<h2>Get-OAIAssistantItem</h2>
<p><strong>Page:</strong> 27</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Retrieves an item from the OpenAI Assistant.</p>
<h3>Description</h3>
<p>The Get-OAIAssistantItem function retrieves an item from the OpenAI Assistant based on the specified AssistantId.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>AssistantId</code></td><td>System.Object</td><td>The ID of the OpenAI Assistant.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Get-OAIAssistantItem -AssistantId "12345678"</code></pre>
<p>This example retrieves an item from the OpenAI Assistant with the ID "12345678".    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param(
        [Parameter(ValueFromPipelineByPropertyName)]
        [Alias('assistant_id')]
        $AssistantId
    )

    Process {

        if($null -eq $AssistantId) {
            return
        }

        $url = $baseUrl + "/assistants/$AssistantId"
        $Method = 'Get'

        Invoke-OAIBeta -Uri $url -Method $Method
    }
</code></pre>
</div>
<div class="page" id="GetOAIFile">
<h2>Get-OAIFile</h2>
<p><strong>Page:</strong> 28</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Retrieves files from a specified URL.</p>
<h3>Description</h3>
<p>The Get-OAIFile function retrieves files from a specified URL using the specified HTTP method. It supports filtering files based on the purpose parameter.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>purpose</code></td><td>System.Object</td><td>Specifies the purpose of the files to retrieve. Valid values are 'fine-tune', 'fine-tune-results', and 'assistants'.</td></tr>
<tr><td><code>Raw</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Get-OAIFile -purpose fine-tune
Retrieves files from the specified URL with the purpose set to 'fine-tune'.</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param (
        [ValidateSet('fine-tune', 'fine-tune-results', 'assistants')]
        $purpose,
        [Switch]$Raw
    )
    
    $url = $baseUrl + "/files"
    $Method = 'Get'

    if ($purpose) {
        $url += "?purpose=$purpose"
    }

    $params = @{
        Uri    = $url
        Method = $Method
    }
    
    $result = Invoke-OAIBeta @params

    if ($Raw) {
        return $result
    } 
    else {
        return $result.data
    }
</code></pre>
</div>
<div class="page" id="GetOAIFileContent">
<h2>Get-OAIFileContent</h2>
<p><strong>Page:</strong> 29</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Retrieves the content of a file from the OpenAI API.</p>
<h3>Description</h3>
<p>The Get-OAIFileContent function retrieves the content of a file from the OpenAI API using the specified FileId. The content can be returned as plain text or in a specified content type. Optionally, the content can be saved to a file.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>FileId</code></td><td>System.Object</td><td>The ID of the file to retrieve the content from.</td></tr>
<tr><td><code>ContentType</code></td><td>System.Object</td><td>The type of content to retrieve. The default value is "text/plain".</td></tr>
<tr><td><code>OutFile</code></td><td>System.Object</td><td>The path to save the content to. If specified, the content will be saved to the specified file.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Get-OAIFileContent -FileId "abc123" -ContentType "application/json" -OutFile "C:\output.json"
Retrieves the content of the file with ID "abc123" from the OpenAI API as JSON and saves it to "C:\output.json".</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param (
        [Parameter(Mandatory)]
        $FileId,
        $ContentType = "text/plain",
        $OutFile
    )

    process {

        $params = @{
            Uri         = $baseUrl + "/files/$FileId/content"
            Method      = "Get"
            ContentType = $ContentType
        }

        if ($OutFile) {
            $params["OutFile"] = $OutFile
        }
 
        Invoke-OAIBeta @params
    }
</code></pre>
</div>
<div class="page" id="GetOAIFileItem">
<h2>Get-OAIFileItem</h2>
<p><strong>Page:</strong> 30</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Retrieves information about a file from the OpenAI API.</p>
<h3>Description</h3>
<p>The Get-OAIFileItem function retrieves information about a file from the OpenAI API by providing the file ID.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>FileId</code></td><td>System.Object</td><td>The ID of the file to retrieve information for.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Get-OAIFileItem -FileId "abc123"
Retrieves information about the file with the ID "abc123" from the OpenAI API.</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param (
        [Parameter(Mandatory)]
        $FileId
    )
    process {
        $uri = $baseUrl + "/files/$FileId"
        $Method = "Get"

        Invoke-OAIBeta -Uri $uri -Method $Method 
    }
</code></pre>
</div>
<div class="page" id="GetOAIFunctionCallSpec">
<h2>Get-OAIFunctionCallSpec</h2>
<p><strong>Page:</strong> 31</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Retrieves the OpenAI function call specification for a given function.</p>
<h3>Description</h3>
<p>The Get-OAIFunctionCallSpec function retrieves the OpenAI function call specification for a given function. It takes a FunctionInfo object as input and returns the function call specification in a tool-specific format.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>functionInfo</code></td><td>System.Management.Automation.FunctionInfo</td><td>Specifies the FunctionInfo object representing the function for which to retrieve the function call specification.</td></tr>
<tr><td><code>Strict</code></td><td>System.Management.Automation.SwitchParameter</td><td>Specifies whether to enforce strict mode when retrieving the function call specification. When strict mode is enabled, the function call specification will include additional information such as parameter descriptions and whether the parameter is required.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Function Test-Func {param($x)}; $functionInfo = Get-Command -Name "Test-Func"
Get-OAIFunctionCallSpec -functionInfo $functionInfo</code></pre>
<p>This example retrieves the function call specification for the "Get-Process" function.    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param(
        [System.Management.Automation.FunctionInfo]$functionInfo,
        [Switch]$Strict
    )

    if ($null -eq $functionInfo) {
        return
    }

    $functions = foreach ($function in $functionInfo) {
        $fnd = Get-FunctionDefinition $function
        ConvertTo-OpenAIFunctionSpec $fnd -Raw -Strict:$Strict
    }

    ConvertTo-ToolFormat $functions
</code></pre>
</div>
<div class="page" id="GetOAIImageGeneration">
<h2>Get-OAIImageGeneration</h2>
<p><strong>Page:</strong> 32</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Generates an image using the OpenAI API.</p>
<h3>Description</h3>
<p>The Get-OAIImageGeneration function generates an image using the OpenAI API by sending a POST request to the '/images/generations' endpoint. It allows you to specify various parameters such as the prompt, model, number of generations, quality, response format, size, style, and user.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>Prompt</code></td><td>System.Object</td><td>Specifies the prompt for generating the image. This parameter is mandatory.</td></tr>
<tr><td><code>Model</code></td><td>System.Object</td><td>Specifies the model to use for generating the image. If not specified, the default model will be used.</td></tr>
<tr><td><code>N</code></td><td>System.Object</td><td>The number of images to generate. Must be between 1 and 10. For dall-e-3, only n=1 is supported.</td></tr>
<tr><td><code>Quality</code></td><td>System.Object</td><td>The quality of the image that will be generated. hd creates images with finer details and greater consistency across the image. This param is only supported for dall-e-3.</td></tr>
<tr><td><code>ResponseFormat</code></td><td>System.Object</td><td>The format in which the generated images are returned. Must be one of url or b64_json. URLs are only valid for 60 minutes after the image has been generated.</td></tr>
<tr><td><code>Size</code></td><td>System.Object</td><td>The size of the generated images. Must be one of 256x256, 512x512, or 1024x1024 for dall-e-2. Must be one of 1024x1024, 1792x1024, or 1024x1792 for dall-e-3 models.</td></tr>
<tr><td><code>Style</code></td><td>System.Object</td><td>The style of the generated images. Must be one of vivid or natural. Vivid causes the model to lean towards generating hyper-real and dramatic images. Natural causes the model to produce more natural, less hyper-real looking images. This param is only supported for dall-e-3.</td></tr>
<tr><td><code>User</code></td><td>System.Object</td><td>Specifies the user for generating the image. If not specified, the default user will be used.</td></tr>
<tr><td><code>Show</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Get-OAIImageGeneration -Prompt "Generate a beautiful landscape image"</code></pre>
<p>Generates an image using the default parameters and the specified prompt.    </p>
<pre><code class='language-powershell'>Get-OAIImageGeneration -Prompt "Generate a cute cat image" -Model "cat-v1" -N 5 -Quality "high" -ResponseFormat "json"</code></pre>
<p>Generates 5 high-quality cat images in JSON format using the specified prompt and model.    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param (
        [Parameter(Mandatory)]
        $Prompt,
        [ValidateSet('dall-e-2', 'dall-e-3')]
        $Model,
        $N,
        [ValidateSet('standard', 'hd')]
        $Quality,
        [ValidateSet('url', 'b64_json')] 
        $ResponseFormat,
        [ValidateSet('256x256', '512x512', '1024x1024', '1792x1024', '1024x1792')]        
        $Size,
        [ValidateSet('vivid', 'natural')]
        $Style,
        $User,
        [Switch]$Show
    )

    $body = @{'prompt' = $Prompt }
    
    if ($null -ne $Model) { 
        $body['model'] = $Model 
    }

    if ($null -ne $N) { 
        $body['n'] = $N 
    }

    if ($null -ne $Quality) { 
        $body['quality'] = $Quality 
    }

    if ($null -ne $ResponseFormat) { 
        $body['response_format'] = $ResponseFormat 
    }

    if ($null -ne $Size) { 
        $body['size'] = $Size 
    }

    if ($null -ne $Style) { 
        $body['style'] = $Style 
    }

    if ($null -ne $User) { 
        $body['user'] = $User 
    }

    $url = $baseUrl + '/images/generations'
    $Method = 'POST'

    $response = Invoke-OAIBeta -Uri $url -Method $Method -Body $body

    if ($Show) {
        Start-Process $response.data.url
    }

    $response
</code></pre>
</div>
<div class="page" id="GetOAIMessage">
<h2>Get-OAIMessage</h2>
<p><strong>Page:</strong> 33</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Retrieves messages for a specific thread ID.</p>
<h3>Description</h3>
<p>The Get-OAIMessage function retrieves messages for a specific thread ID. It allows you to specify various parameters such as the number of messages to retrieve, the order in which they should be sorted, and filters based on timestamps and run IDs.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>ThreadId</code></td><td>System.Object</td><td>The ID of the thread for which messages should be retrieved.</td></tr>
<tr><td><code>Limit</code></td><td>System.Object</td><td>The maximum number of messages to retrieve. The default value is 20.</td></tr>
<tr><td><code>Order</code></td><td>System.Object</td><td>The order in which the messages should be sorted. Valid values are 'asc' (ascending) and 'desc' (descending). The default value is 'desc'.</td></tr>
<tr><td><code>After</code></td><td>System.Object</td><td>Retrieve messages after the specified timestamp.</td></tr>
<tr><td><code>Before</code></td><td>System.Object</td><td>Retrieve messages before the specified timestamp.</td></tr>
<tr><td><code>RunId</code></td><td>System.Object</td><td>Retrieve messages for a specific run ID.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Get-OAIMessage -ThreadId 12345 -Limit 10 -Order 'asc' -After '2022-01-01' -RunId 'abc123'
Retrieves the 10 oldest messages for the thread with ID 12345, sorted in ascending order, after the specified timestamp, and for the specified run ID.</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    param(
        [Parameter(ValueFromPipelineByPropertyName)]
        [Alias('thread_id')]
        [Alias('id')]
        $ThreadId,
        $Limit = 20,
        [ValidateSet('asc', 'desc')]
        $Order = 'desc',
        $After,
        $Before,
        $RunId
    )

    Process {

        if ($null -eq $ThreadId) {
            return
        }

        $Method = 'Get'
        $url = $baseUrl + "/threads/$ThreadId/messages"

        $urlParams = @()
        if ($limit) {
            $urlParams += "limit=$limit"
        }
        if ($order) {
            $urlParams += "order=$order"
        }
        if ($after) {
            $urlParams += "after=$after"
        }
        if ($before) {
            $urlParams += "before=$before"
        }
        if ($runId) {
            $urlParams += "run_id=$runId"
        }

        $urlParams = "?" + ($urlParams -join '&')

        Invoke-OAIBeta -Uri ($url + $urlParams) -Method $Method
    }
</code></pre>
</div>
<div class="page" id="GetOAIMessageItem">
<h2>Get-OAIMessageItem</h2>
<p><strong>Page:</strong> 34</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> 
Get-OAIMessageItem [[-ThreadId] <Object>] [[-MessageId] <Object>] [<CommonParameters>]
</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>ThreadId</code></td><td>System.Object</td><td></td></tr>
<tr><td><code>MessageId</code></td><td>System.Object</td><td></td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    param(
        [Parameter(ValueFromPipelineByPropertyName)]
        [Alias('thread_id')]
        $ThreadId,
        [Parameter(ValueFromPipelineByPropertyName)]
        [Alias('id')]
        $MessageId
    )

    Process {

        if ($null -eq $ThreadId -or $null -eq $MessageId) {
            return
        }

        $Method = 'Get'
        $url = $baseUrl + "/threads/$ThreadId/messages/$MessageId"

        Invoke-OAIBeta -Uri $url -Method $Method
    }
</code></pre>
</div>
<div class="page" id="GetOAIProvider">
<h2>Get-OAIProvider</h2>
<p><strong>Page:</strong> 35</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Retrieves the OAI provider.</p>
<h3>Description</h3>
<p>This function retrieves the OAI provider.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Get-OAIProvider</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    $script:OAIProvider
</code></pre>
</div>
<div class="page" id="GetOAIRun">
<h2>Get-OAIRun</h2>
<p><strong>Page:</strong> 36</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Retrieves the runs associated with a specific thread ID.</p>
<h3>Description</h3>
<p>The Get-OAIRun function retrieves the runs associated with a specific thread ID from a specified base URL. It allows you to specify various parameters such as the number of runs to retrieve, the order in which they should be sorted, and the time range for the runs.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>threadId</code></td><td>System.Object</td><td>Specifies the ID of the thread for which to retrieve the runs. This parameter is mandatory.</td></tr>
<tr><td><code>limit</code></td><td>System.Object</td><td>Specifies the maximum number of runs to retrieve. The default value is 20.</td></tr>
<tr><td><code>order</code></td><td>System.Object</td><td>Specifies the order in which the runs should be sorted. Valid values are 'asc' (ascending) and 'desc' (descending). The default value is 'desc'.</td></tr>
<tr><td><code>after</code></td><td>System.Object</td><td>Specifies the timestamp after which the runs should be retrieved.</td></tr>
<tr><td><code>before</code></td><td>System.Object</td><td>Specifies the timestamp before which the runs should be retrieved.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Get-OAIRun -threadId 12345 -limit 10 -order 'asc' -after '2022-01-01T00:00:00Z'
Retrieves the 10 oldest runs associated with thread ID 12345, sorted in ascending order, and after the specified timestamp.</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param(
        [Parameter(ValueFromPipelineByPropertyName)]
        [Alias('thread_id')]
        $threadId,
        $limit = 20,
        [ValidateSet('asc', 'desc')]
        $order = 'desc',
        $after,
        $before        
    )

    Process {
        $url = $baseUrl + "/threads/$threadId/runs"
        $Method = 'Get'

        $urlParams = @()
        if ($limit) {
            $urlParams += "limit=$limit"
        }
        if ($order) {
            $urlParams += "order=$order"
        }
        if ($after) {
            $urlParams += "after=$after"
        }
        if ($before) {
            $urlParams += "before=$before"
        }

        $urlParams = "?" + ($urlParams -join '&')
        Invoke-OAIBeta -Uri ($url + $urlParams) -Method $Method
    }
</code></pre>
</div>
<div class="page" id="GetOAIRunItem">
<h2>Get-OAIRunItem</h2>
<p><strong>Page:</strong> 37</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Retrieves information about a specific run item.</p>
<h3>Description</h3>
<p>The Get-OAIRunItem function retrieves information about a specific run item based on the provided thread ID and run ID.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>ThreadId</code></td><td>System.Object</td><td>The ID of the thread associated with the run item. This parameter is mandatory.</td></tr>
<tr><td><code>RunId</code></td><td>System.Object</td><td>The ID of the run item to retrieve information for. This parameter is mandatory.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Get-OAIRunItem -threadId 123 -runId 456
Retrieves information about the run item with thread ID 123 and run ID 456.</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param(
        [Parameter(ValueFromPipelineByPropertyName)]
        [Alias('thread_id')]        
        $ThreadId,
        [Parameter(ValueFromPipelineByPropertyName)]
        [Alias('run_id')]
        $RunId
    )

    Process {
        if ($null -eq $ThreadID -or $null -eq $RunId) {
            return
        }

        $url = $baseUrl + "/threads/$ThreadID/runs/$RunId"
        $Method = 'Get'

        Invoke-OAIBeta -Uri $url -Method $Method
    }
</code></pre>
</div>
<div class="page" id="GetOAIRunStep">
<h2>Get-OAIRunStep</h2>
<p><strong>Page:</strong> 38</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Retrieves the run steps for a specific thread and run ID.</p>
<h3>Description</h3>
<p>The Get-OAIRunStep function retrieves the run steps for a specific thread and run ID. It allows you to specify optional parameters such as the number of steps to retrieve, the order in which the steps should be sorted, and filters based on timestamps.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>ThreadId</code></td><td>System.Object</td><td>The ID of the thread for which to retrieve the run steps. This parameter is mandatory.</td></tr>
<tr><td><code>RunId</code></td><td>System.Object</td><td>The ID of the run for which to retrieve the steps. This parameter is mandatory.</td></tr>
<tr><td><code>Limit</code></td><td>System.Object</td><td>The maximum number of steps to retrieve. The default value is 20.</td></tr>
<tr><td><code>Order</code></td><td>System.Object</td><td>The order in which the steps should be sorted. Valid values are 'asc' (ascending) and 'desc' (descending). The default value is 'desc'.</td></tr>
<tr><td><code>After</code></td><td>System.Object</td><td>Retrieve steps that occurred after which is an object ID that defines your place in the list.</td></tr>
<tr><td><code>Before</code></td><td>System.Object</td><td>Retrieve steps that occurred before which is an object ID that defines your place in the list.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Get-OAIRunStep -threadId 123 -runId 456
Retrieves the run steps for thread ID 123 and run ID 456.</code></pre>
<p>    </p>
<pre><code class='language-powershell'>Get-OAIRunStep -threadId 123 -runId 456 -limit 50 -order 'asc' -after '2022-01-01T00:00:00Z'
Retrieves the first 50 run steps in ascending order that occurred after January 1, 2022.</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param(
        [Parameter(Mandatory)]
        $ThreadId,
        [Parameter(Mandatory)]
        $RunId,
        $Limit,
        [ValidateSet('asc', 'desc')]
        $Order = 'desc',
        $After,
        $Before
    )

    $url = $baseUrl + "/threads/$ThreadId/runs/$RunId/steps"
    $Method = 'Get'

    $urlParams = @()
    if ($Limit) {
        $urlParams += "limit=$Limit"
    }
    if ($Order) {
        $urlParams += "order=$Order"
    }
    if ($After) {
        $urlParams += "after=$After"
    }
    if ($Before) {
        $urlParams += "before=$Before"
    }

    $urlParams = "?" + ($urlParams -join '&')
    Invoke-OAIBeta -Uri ($url + $urlParams) -Method $Method
</code></pre>
</div>
<div class="page" id="GetOAIRunStepItem">
<h2>Get-OAIRunStepItem</h2>
<p><strong>Page:</strong> 39</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> 
Get-OAIRunStepItem [-ThreadId] <Object> [-RunId] <Object> [-StepId] <Object> [<CommonParameters>]
</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>ThreadId</code></td><td>System.Object</td><td></td></tr>
<tr><td><code>RunId</code></td><td>System.Object</td><td></td></tr>
<tr><td><code>StepId</code></td><td>System.Object</td><td></td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param(
        [Parameter(Mandatory)]
        $ThreadId,
        [Parameter(Mandatory)]
        $RunId,
        [Parameter(Mandatory)]
        $StepId
    )
    
    $url = $baseUrl + "/threads/$ThreadId/runs/$RunId/steps/$StepId"
    $Method = 'Get'

    Invoke-OAIBeta -Url $url -Method $Method
</code></pre>
</div>
<div class="page" id="GetOAIThread">
<h2>Get-OAIThread</h2>
<p><strong>Page:</strong> 40</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Retrieves information about a specific thread.</p>
<h3>Description</h3>
<p>The Get-OAIThread function retrieves information about a specific thread identified by its thread ID.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>threadId</code></td><td>System.Object</td><td>The ID of the thread to retrieve information for.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Get-OAIThread -threadId 12345
Retrieves information about the thread with ID 12345.</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param(
        [Parameter(Mandatory)]
        $threadId
    )

    $url = $baseUrl + "/threads/$threadId"
    $Method = 'Get'

    Invoke-OAIBeta -Uri $url -Method $Method
</code></pre>
</div>
<div class="page" id="GetOAIThreadItem">
<h2>Get-OAIThreadItem</h2>
<p><strong>Page:</strong> 41</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Retrieves an item from an OpenAPI thread.</p>
<h3>Description</h3>
<p>The Get-OAIThreadItem function retrieves an item from an OpenAPI thread based on the specified thread ID.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>ThreadId</code></td><td>System.Object</td><td>The ID of the thread from which to retrieve the item.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Get-OAIThreadItem -ThreadId 12345
Retrieves the item from the OpenAPI thread with the ID 12345.</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param(
        [Parameter(ValueFromPipelineByPropertyName)]
        [Alias('thread_id')]
        $ThreadId
    )

    Process {
        $url = $baseUrl + "/threads/$ThreadId"
        $Method = 'Get'

        Invoke-OAIBeta -Uri $url -Method $Method
    }
</code></pre>
</div>
<div class="page" id="GetOAIVectorStore">
<h2>Get-OAIVectorStore</h2>
<p><strong>Page:</strong> 42</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Retrieves vector stores from the specified base URL.</p>
<h3>Description</h3>
<p>The Get-OAIVectorStore function retrieves vector stores from the specified base URL. It supports various parameters such as limit, order, after, before, and raw output.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>limit</code></td><td>System.Object</td><td>A limit on the number of objects to be returned. Limit can range between 1 and 100, and the default is 20.</td></tr>
<tr><td><code>order</code></td><td>System.Object</td><td>Sort order by the created_at timestamp of the objects. asc for ascending order and desc for descending order.</td></tr>
<tr><td><code>after</code></td><td>System.Object</td><td>A cursor for use in pagination. after is an object ID that defines your place in the list. For instance, if you make a list request and receive 100 objects, ending with obj_foo, your subsequent call can include after=obj_foo in order to fetch the next page of the list.</td></tr>
<tr><td><code>before</code></td><td>System.Object</td><td>A cursor for use in pagination. before is an object ID that defines your place in the list. For instance, if you make a list request and receive 100 objects, ending with obj_foo, your subsequent call can include before=obj_foo in order to fetch the previous page of the list.</td></tr>
<tr><td><code>Raw</code></td><td>System.Management.Automation.SwitchParameter</td><td>Switch parameter. If specified, the function returns the raw response object. Otherwise, it returns only the data property of the response.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Get-OAIVectorStore -limit 10 -order desc
Retrieves the 10 most recent vector stores in descending order.</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param (
        $limit,
        [ValidateSet('asc', 'desc')]
        $order = 'desc',
        $after,
        $before,
        [Switch]$Raw
    )

    process {
        $uri = $baseUrl + "/vector_stores"
        $Method = "Get"

        $queryParams = @()

        if ($limit) {
            $queryParams += "limit=$limit"
        }

        if ($order) {
            $queryParams += "order=$order"
        }

        if ($after) {
            $queryParams += "after=$after"
        }

        if ($before) {
            $queryParams += "before=$before"
        }

        if ($queryParams.Count -gt 0) {
            $uri += "?" + ($queryParams -join "&")
        }

        $params = @{
            Uri    = $uri
            Method = $Method
        }

        $response = Invoke-OAIBeta @params

        if ($Raw) {
            return $response
        }
        else {
            return $response.data
        }
    }
</code></pre>
</div>
<div class="page" id="GetOAIVectorStoreFile">
<h2>Get-OAIVectorStoreFile</h2>
<p><strong>Page:</strong> 43</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Retrieves files from a vector store.</p>
<h3>Description</h3>
<p>The Get-OAIVectorStoreFile function retrieves files from a vector store based on the specified parameters. It sends a GET request to the vector store API endpoint and returns the files that match the specified criteria.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>VectorStoreId</code></td><td>System.Object</td><td>The ID of the vector store from which to retrieve the files.</td></tr>
<tr><td><code>limit</code></td><td>System.Object</td><td>The maximum number of files to retrieve. The default value is 20.</td></tr>
<tr><td><code>order</code></td><td>System.Object</td><td>The order in which the files should be sorted. Valid values are 'asc' (ascending) and 'desc' (descending). The default value is 'desc'.</td></tr>
<tr><td><code>after</code></td><td>System.Object</td><td>Retrieve files that were created after the specified date and time.</td></tr>
<tr><td><code>before</code></td><td>System.Object</td><td>Retrieve files that were created before the specified date and time.</td></tr>
<tr><td><code>filter</code></td><td>System.Object</td><td>A filter to apply to the files. This can be used to narrow down the results based on specific criteria. One of in_progress, completed, failed, cancelled.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Get-OAIVectorStoreFile -VectorStoreId "12345" -Limit 50 -Order "asc" -After "2022-01-01" -Filter "name eq 'example.txt'"
Retrieves the first 50 files from the vector store with ID "12345", sorted in ascending order, that were created after January 1, 2022, and have the name "example.txt".</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param (
        [Parameter(Mandatory)]
        $VectorStoreId,
        $limit = 20,
        [ValidateSet('asc', 'desc')]
        $order = 'desc',
        $after,
        $before,
        [ValidateSet('in_progress', 'completed', 'failed', 'cancelled')]
        $filter
    )

    $params = @{
        Uri    = $baseUrl + "/vector_stores/$VectorStoreId/files"
        Method = "Get"
    }

    $queryParams = @()

    if ($limit) {
        $queryParams += "limit=$limit"
    }

    if ($order) {
        $queryParams += "order=$order"
    }

    if ($after) {
        $queryParams += "after=$after"
    }

    if ($before) {
        $queryParams += "before=$before"
    }

    if ($filter) {
        $queryParams += "filter=$filter"
    }

    if ($queryParams.Count -gt 0) {
        $params.Uri += "?" + ($queryParams -join "&")
    }

    $response = Invoke-OAIBeta @params

    if ($null -ne $response) {
        return $response.data
    }
</code></pre>
</div>
<div class="page" id="GetOAIVectorStoreFileBatch">
<h2>Get-OAIVectorStoreFileBatch</h2>
<p><strong>Page:</strong> 44</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Retrieves information about a specific file batch in an OpenAI Vector Store.</p>
<h3>Description</h3>
<p>The Get-OAIVectorStoreFileBatch function retrieves information about a specific file batch in an OpenAI Vector Store. It requires the VectorStoreId and BatchId parameters to identify the file batch.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>VectorStoreId</code></td><td>System.Object</td><td>Specifies the ID of the Vector Store that contains the file batch.</td></tr>
<tr><td><code>BatchId</code></td><td>System.Object</td><td>Specifies the ID of the file batch to retrieve information for.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Get-OAIVectorStoreFileBatch -VectorStoreId "store1" -BatchId "batch1"
Retrieves information about the file batch with ID "batch1" in the Vector Store with ID "store1".</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param(
        [Parameter(Mandatory)]
        $VectorStoreId,
        [Parameter(Mandatory)]
        $BatchId
    )
    
    $params = @{
        Uri    = $baseUrl + "/vector_stores/$VectorStoreId/file_batches/$BatchId"
        Method = "Get"
    }

    Invoke-OAIBeta @params
</code></pre>
</div>
<div class="page" id="GetOAIVectorStoreFileItem">
<h2>Get-OAIVectorStoreFileItem</h2>
<p><strong>Page:</strong> 45</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Retrieves a specific file item from an OpenAI Vector Store.</p>
<h3>Description</h3>
<p>The Get-OAIVectorStoreFileItem function retrieves a specific file item from an OpenAI Vector Store based on the provided VectorStoreId and FileId.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>VectorStoreId</code></td><td>System.Object</td><td>The ID of the Vector Store from which to retrieve the file item. This parameter is mandatory.</td></tr>
<tr><td><code>FileId</code></td><td>System.Object</td><td>The ID of the file item to retrieve. This parameter is mandatory.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Get-OAIVectorStoreFileItem -VectorStoreId "12345" -FileId "67890"
Retrieves the file item with the ID "67890" from the Vector Store with the ID "12345".</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param (
        [Parameter(Mandatory)]
        $VectorStoreId,
        [Parameter(Mandatory)]
        $FileId
    )

    $params = @{
        Uri    = $baseUrl + "/vector_stores/$VectorStoreId/files/$FileId"
        Method = "Get"
    }

    Invoke-OAIBeta @params
</code></pre>
</div>
<div class="page" id="GetOAIVectorStoreFilesInBatch">
<h2>Get-OAIVectorStoreFilesInBatch</h2>
<p><strong>Page:</strong> 46</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> 
Get-OAIVectorStoreFilesInBatch [-VectorStoreId] <Object> [-BatchId] <Object> [[-limit] <Object>] [[-order] <Object>] [[-after] <Object>] [[-before] <Object>] [[-filter] <Object>] [<CommonParameters>]
</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>VectorStoreId</code></td><td>System.Object</td><td></td></tr>
<tr><td><code>BatchId</code></td><td>System.Object</td><td></td></tr>
<tr><td><code>limit</code></td><td>System.Object</td><td></td></tr>
<tr><td><code>order</code></td><td>System.Object</td><td></td></tr>
<tr><td><code>after</code></td><td>System.Object</td><td></td></tr>
<tr><td><code>before</code></td><td>System.Object</td><td></td></tr>
<tr><td><code>filter</code></td><td>System.Object</td><td></td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    param(
        [Parameter(Mandatory)]
        $VectorStoreId,
        [Parameter(Mandatory)]
        $BatchId,
        $limit,
        $order,
        $after,
        $before,
        $filter
    )

    $uri = $baseUrl + "/vector_stores/$VectorStoreId/file_batches/$BatchId/files"
    $query = @()

    if ($limit) {
        $query += "limit=$limit"
    }

    if ($order) {
        $query += "order=$order"
    }

    if ($after) {
        $query += "after=$after"
    }

    if ($before) {
        $query += "before=$before"
    }

    if ($filter) {
        $query += "filter=$filter"
    }

    if ($query.Count -gt 0) {
        $uri += "?" + ($query -join "&")
    }

    $params = @{
        Uri    = $uri
        Method = 'GET'
    }

    $response = Invoke-OAIBeta @params

    if ($null -ne $response) {
        return $response.data
    }
</code></pre>
</div>
<div class="page" id="GetOAIVectorStoreItem">
<h2>Get-OAIVectorStoreItem</h2>
<p><strong>Page:</strong> 47</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Retrieves an item from the OpenAI Vector Store.</p>
<h3>Description</h3>
<p>The Get-OAIVectorStoreItem function retrieves an item from the OpenAI Vector Store based on the specified VectorStoreId.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>VectorStoreId</code></td><td>System.Object</td><td>The ID of the vector store item to retrieve.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Get-OAIVectorStoreItem -VectorStoreId vs_SvMW6In5Y5D5Sl44Aae05eho
Retrieves the vector store item with the specified ID.</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param (
        [Parameter(ValueFromPipelineByPropertyName)]
        [Alias('Id')]
        $VectorStoreId
    )

    process {
        $uri = $baseUrl + "/vector_stores/$($VectorStoreId)"
        $Method = "Get"

        Invoke-OAIBeta -Uri $uri -Method $Method 
    }
</code></pre>
</div>
<div class="page" id="GetOpenAISpecDescriptions">
<h2>Get-OpenAISpecDescriptions</h2>
<p><strong>Page:</strong> 48</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> 
Get-OpenAISpecDescriptions [[-target] <Object>] [<CommonParameters>]
</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>target</code></td><td>System.Object</td><td></td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param(        
        $target
    )

    if ($null -eq $target) {
        Write-Warning "Empty. Could not find any descriptions."
        return
    }

    $pattern = '(?s)(?<=<#)(.*?)(?=#>)'

    $targetMatches = [regex]::Matches($target, $pattern)

    $r = $targetMatches[0].Value -split "`n" | ForEach-Object { $_.Trim() } 

    $result = @{
        FunctionDescription  = $null
        ParameterDescription = @{}
    }

    for ($idx = 0; $idx -lt $r.Count; $idx++) {
        $item = $r[$idx]
        if ($item) {        
            if ($item -match '^\.FUNCTIONDESCRIPTION') {
                $result.FunctionDescription = $r[$idx + 1]
            }
            elseif ($item -match '^\.PARAMETERDESCRIPTION') {
                $kw, $name = $item -split ' '                
                $result.ParameterDescription.$name = $ExecutionContext.InvokeCommand.ExpandString($r[$idx + 1])
            }
        }
    }

    $result
</code></pre>
</div>
<div class="page" id="GetUnitTestingData">
<h2>Get-UnitTestingData</h2>
<p><strong>Page:</strong> 49</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> 
Get-UnitTestingData 
</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
</table>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    $script:InvokeOAIUnitTestingData
</code></pre>
</div>
<div class="page" id="GetUnitTestingStatus">
<h2>Get-UnitTestingStatus</h2>
<p><strong>Page:</strong> 50</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Gets the status of unit testing.</p>
<h3>Description</h3>
<p>The Get-UnitTestingStatus function returns the current value of the $EnableUnitTesting variable, indicating whether unit testing is enabled or disabled.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Get-UnitTestingStatus</code></pre>
<p>This example retrieves the current status of unit testing.    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    $script:EnableUnitTesting
</code></pre>
</div>
<div class="page" id="ImportOAIAssistant">
<h2>Import-OAIAssistant</h2>
<p><strong>Page:</strong> 51</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Imports an OAI Assistant from a JSON file.</p>
<h3>Description</h3>
<p>The Import-OAIAssistant function imports an OAI Assistant from a JSON file and creates a new OAI Assistant object.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>Path</code></td><td>System.String</td><td>The path to the JSON file containing the OAI Assistant properties.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Import-OAIAssistant -Path "C:\OAIAssistant.json"</code></pre>
<p>This example imports an OAI Assistant from the "C:\OAIAssistant.json" file.    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param (
        [Parameter(Mandatory)]
        [string]$Path
    )

    if (-not (Test-Path $Path)) {
        throw "File not found at $Path"
    }

    $assistantProperties = Get-Content $Path -Raw | ConvertFrom-Json -Depth 10 -AsHashtable
    New-OAIAssistant @assistantProperties
</code></pre>
</div>
<div class="page" id="InvokeAIExplain">
<h2>Invoke-AIExplain</h2>
<p><strong>Page:</strong> 52</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Invokes an AI to explain a given text.</p>
<h3>Description</h3>
<p>The Invoke-AIExplain function is used to invoke an AI to explain a given text. It provides an interactive prompt for the user to enter the text they want to explain. If no text is provided, it will use the last command from the command history. The function supports an optional switch parameter to display the explanation as a bullet list.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>Text</code></td><td>System.Object</td><td>Specifies the text to be explained. If not provided, the last command from the command history will be used.</td></tr>
<tr><td><code>AsBulletList</code></td><td>System.Management.Automation.SwitchParameter</td><td>Displays the explanation as a bullet list if this switch is specified.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Invoke-AIExplain -Text "This is a sample text to be explained."</code></pre>
<p>This example invokes the AI to explain the provided text.    </p>
<pre><code class='language-powershell'>Invoke-AIExplain -AsBulletList</code></pre>
<p>This example invokes the AI to explain the last command from the command history and displays the explanation as a bullet list.    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    [alias("explain")]
    param (
        $Text,
        [Switch]$AsBulletList
    )

    if ($null -eq $Text) {
        # read history
        $Text = (Get-History -Count 1).CommandLine
    }
      
    if ($AsBulletList) {
        $bulletListPrompt = "I have the preference for bulleted lists. I personally digest information better that way."
    }

    $prompt = @"
Be brief, and explain thouroughly.
You are running powershell on $($PSVersionTable.Platform).
$($bulletListPrompt)

Please explain the following:

$text
"@

    Write-Host "Getting explanation..." -ForegroundColor Yellow
    $result = ai $prompt

    if (Get-Command glow -ErrorAction SilentlyContinue) {
        $result | glow
    }
    else {
        $result        
    }
</code></pre>
</div>
<div class="page" id="InvokeAIPrompt">
<h2>Invoke-AIPrompt</h2>
<p><strong>Page:</strong> 53</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Prompts the user for input using OpenAI ChatGPT and returns the generated response.</p>
<h3>Description</h3>
<p>The Invoke-AIPrompt function prompts the user for input using OpenAI ChatGPT and returns the generated response. It sends a series of messages to the ChatGPT model, including system messages and user messages, to guide the conversation.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>Prompt</code></td><td>System.Object</td><td>Specifies the prompt message to be displayed to the user.</td></tr>
<tr><td><code>Data</code></td><td>System.Object</td><td>Specifies the data to be included in the conversation. This data will be displayed to the user before the prompt.</td></tr>
<tr><td><code>Model</code></td><td>System.Object</td><td>Specifies the ChatGPT model to use for generating the response. The default value is 'gpt-4o-mini'.</td></tr>
<tr><td><code>UsePowerShellPersona</code></td><td>System.Management.Automation.SwitchParameter</td><td>Indicates whether to use a PowerShell persona for the conversation. If this switch is specified, a system message will be added to the conversation to inform the model that the user is a PowerShell expert.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>$data = @"
Region,State,Units,Price
West,Texas,927,923.71
North,Tennessee,466,770.67
East,Florida,520,458.68w
East,Maine,828,661.24
West,Virginia,465,53.58
North,Missouri,436,235.67
South,Kansas,214,992.47
North,North Dakota,789,640.72
South,Delaware,712,508.55
"@</code></pre>
<p>Invoke-AIPrompt -Prompt "top 3" -Data $data

This example prompts the user with the question "What is the capital of France?" and includes the question in the conversation data. The function then returns the generated response from the ChatGPT model.    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param(
        [Parameter(Mandatory)]
        $Prompt,
        [Parameter(Mandatory)]
        $Data,
        $Model = 'gpt-4o-mini',
        [Switch]$UsePowerShellPersona
    )

    $messages = @()
    if ($UsePowerShellPersona) {
        $messages += New-ChatRequestSystemMessage "You are tuned to be a PowerShell expert. Answer the question in the style of Doug Finke Microsoft PowerShell MVP."
    }

    $messages += New-ChatRequestSystemMessage "Here is the data, please answer the question:`n $(ConvertTo-Json -Compress $Data -Depth 10)"

    $messages += New-ChatRequestUserMessage $Prompt

    $result = Invoke-OAIChatCompletion -Messages $messages
    $result.choices[0].message.content
</code></pre>
</div>
<div class="page" id="InvokeFilesToPrompt">
<h2>Invoke-FilesToPrompt</h2>
<p><strong>Page:</strong> 54</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Concatenate a directory full of files into a single prompt for use with LLMs</p>
<h3>Description</h3>
<p>Takes one or more paths to files or directories and outputs every file, recursively, each one preceded with its filename like this:

path/to/file.ps1
----
Contents of file.ps1 goes here

---
path/to/file2.ps1
---
...</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>Path</code></td><td>System.Object</td><td>Specifies the path of the files to be processed.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Invoke-FilesToPrompt -Path "C:\MyFiles"</code></pre>
<p>This example invokes the Invoke-FilesToPrompt function to process files in the "C:\MyFiles" directory.    </p>
<pre><code class='language-powershell'>Invoke-FilesToPrompt -Path "C:\MyFiles\*.md"</code></pre>
<p>This example invokes the Invoke-FilesToPrompt function to process all Markdown files in the "C:\MyFiles" directory.    </p>
<pre><code class='language-powershell'>Invoke-FilesToPrompt -Path "C:\MyFiles\*.md", "C:\MyOtherFiles\*.md"</code></pre>
<p>This example invokes the Invoke-FilesToPrompt function to process all Markdown files in the "C:\MyFiles" directory.    </p>
<pre><code class='language-powershell'>(Invoke-FilesToPrompt (dir . -r *.md))</code></pre>
<p>This example recursively processes all Markdown files in the current directory.    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param (
        $Path
    )

    foreach ($item in $Path) {
        if (!(Test-Path $item) ) {
            Write-Host "$item does not exist." -ForegroundColor Red
            continue
        }

        Write-Host "Processing $item" -ForegroundColor Green
        foreach ($targetItem in Get-ChildItem $item -Recurse) {
            $content = Get-Content $targetItem.FullName -raw
            @"
$($targetItem.FullName)
---
$content

"@    
        }
    }
</code></pre>
</div>
<div class="page" id="InvokeOAIBeta">
<h2>Invoke-OAIBeta</h2>
<p><strong>Page:</strong> 55</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Invokes an OpenAI API endpoint using the OpenAI-Beta header.</p>
<h3>Description</h3>
<p>The Invoke-OAIBeta function is used to send requests to an OpenAI API endpoint. It supports various parameters such as the URI, HTTP method, request body, content type, output file, and more.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>Uri</code></td><td>System.Object</td><td>Specifies the URI of the OpenAI API endpoint.</td></tr>
<tr><td><code>Method</code></td><td>System.Object</td><td>Specifies the HTTP method to be used for the request (e.g., GET, POST, PUT, DELETE).</td></tr>
<tr><td><code>Body</code></td><td>System.Object</td><td>Specifies the request body to be sent with the API request.</td></tr>
<tr><td><code>ContentType</code></td><td>System.Object</td><td>Specifies the content type of the request body. The default value is 'application/json'.</td></tr>
<tr><td><code>OutFile</code></td><td>System.Object</td><td>Specifies the path to save the response content to a file.</td></tr>
<tr><td><code>NotOpenAIBeta</code></td><td>System.Management.Automation.SwitchParameter</td><td>If specified, removes the 'OpenAI-Beta' header from the request.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Invoke-OAIBeta -Uri 'https://api.openai.com/v1/endpoint' -Method 'GET' -OutFile 'response.json'</code></pre>
<p>This example sends a GET request to the specified API endpoint and saves the response content to a file named 'response.json'.    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param(
        $Uri,
        $Method,
        $Body,
        $ContentType = 'application/json',
        $OutFile,        
        [Switch]$NotOpenAIBeta        
    )        
    
    $headers = @{
        'OpenAI-Beta'  = 'assistants=v2'    
        'Content-Type' = $ContentType
    }

    if ($NotOpenAIBeta) {
        $headers.Remove('OpenAI-Beta')
    }

    $Provider = Get-OAIProvider
    $AzOAISecrets = Get-AzOAISecrets
    switch ($Provider) {
        'OpenAI' {
            $headers['Authorization'] = "Bearer $env:OpenAIKey"
        }

        'AzureOpenAI' {
            $headers['api-key'] = "$($AzOAISecrets.apiKEY)"
            
            if ($Body -isnot [System.IO.Stream]) {
                if ($null -ne $Body -and $Body.Contains("model") ) {
                    $Body.model = $AzOAISecrets.deploymentName
                }
            }

            $Uri = $Uri -replace $baseUrl, ''
            if ($Uri.EndsWith('/')) {
                $Uri = $Uri.Substring(0, $Uri.Length - 1)
            }
            
            $separator = '?'
            if ($Uri.Contains('?')) {
                $separator = '&'
            }
            $Uri = "{0}/openai{1}{2}api-version={3}" -f $AzOAISecrets.apiURI, $Uri, $separator, $AzOAISecrets.apiVersion         
        }
    }    

    $params = @{
        Uri     = $Uri
        Method  = $Method
        Headers = $headers
    }
    
    if ($Body) {
        if ($Body -is [System.IO.Stream]) {
            $params['Body'] = $Body
        }
        else {
            $params['Body'] = $Body | ConvertTo-Json -Depth 10
        }
    }

    if ($OutFile) {
        $params['OutFile'] = $OutFile
    }

    Write-Verbose ($params | ConvertTo-Json -Depth 5)
    
    if (Test-IsUnitTestingEnabled) {
        Write-Host "Data saved. Use Get-UnitTestingData to retrieve the data."
        $script:InvokeOAIUnitTestingData = @{
            Uri           = $Uri
            Method        = $Method
            Headers       = $headers.Clone()
            Body          = $Body
            OAIProvider   = Get-OAIProvider            
            ContentType   = $ContentType
            OutFile       = $OutFile
            NotOpenAIBeta = $NotOpenAIBeta
        }        
        return
    }

    try {
        Invoke-RestMethod @params
    } 
    catch {
        if ($Provider -eq 'OpenAI') {
            $message = $_.ErrorDetails.Message
            if (Test-JsonReplacement $message -ErrorAction SilentlyContinue) {            
                $targetError = $message | ConvertFrom-Json
                $targetError = $targetError.error.message
            } 
            else {
                $targetError = "[{0}] - {1}" -f $Uri, $message
            }
        }

        if ($Provider -eq 'AzureOpenAI') {
            $targetError = $_.Exception.Message
        }

        # Write-Error $targetError
        throw $targetError
    }
</code></pre>
</div>
<div class="page" id="InvokeOAIChat">
<h2>Invoke-OAIChat</h2>
<p><strong>Page:</strong> 56</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Invokes an AI chat assistant to answer user questions.</p>
<h3>Description</h3>
<p>The Invoke-OAIChat function is used to interact with an AI chat assistant. It takes user input as a parameter and returns the assistant's response.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>UserInput</code></td><td>System.Object</td><td>Specifies the user input to be processed by the AI chat assistant.</td></tr>
<tr><td><code>Instructions</code></td><td>System.Object</td><td></td></tr>
<tr><td><code>model</code></td><td>System.Object</td><td>Specifies the model to be used by the AI chat assistant. Valid values are 'gpt-4', 'gpt-3.5-turbo', 'gpt-3.5-turbo-16k', 'gpt-4-1106-preview', 'gpt-4-turbo-preview', and 'gpt-3.5-turbo-1106'. The default value is 'gpt-3.5-turbo'.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Invoke-OAIChat -UserInput "What is the weather today?"
Invokes the AI chat assistant with the specified user input and returns the assistant's response.</code></pre>
<p>    </p>
<pre><code class='language-powershell'>'show even numbers' | ai -Instructions 'use powershell, just code, no explanation'</code></pre>
<p>    </p>
<pre><code class='language-powershell'>git status | ai 'write a detailed commit message'</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param(
        [Parameter(ValueFromPipeline)]
        $UserInput,
        $Instructions,
        $model = 'gpt-4o-mini'
    )

    Begin {
        $assistantParams = @{}

        $ts = Get-Date -Format "yyyyMMddHHmmss"

        $assistantParams["name"] = "PSAI-$ts"

        if (!$Instructions) {
            $Instructions = 'You are a helpful assistant. Please answer questions concisely.'
        }
        $assistantParams["instructions"] = $Instructions
        $assistantParams["model"] = $model

        $assistant = New-OAIAssistant @assistantParams

        [System.Collections.ArrayList]$lines = @()
    }

    Process {
        $lines += $UserInput                
    }
    
    End {
        $prompt = ($lines | Out-String).Trim()

        $queryResult = New-OAIThreadQuery -UserInput $prompt -Assistant $assistant 
        $null = Wait-OAIOnRun -Run $queryResult.Run -Thread $queryResult.Thread
        $messages = Get-OAIMessage -ThreadId $queryResult.Thread.Id
        $messages.data[0].content.text.value
        $null = Remove-OAIAssistant -Id $assistant.Id
    }
</code></pre>
</div>
<div class="page" id="InvokeOAIChatCompletion">
<h2>Invoke-OAIChatCompletion</h2>
<p><strong>Page:</strong> 57</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Invokes the OpenAI Chat Completions API.</p>
<h3>Description</h3>
<p>This function sends a request to the OpenAI Chat Completions API to generate a chat-based completion.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>Messages</code></td><td>System.Object</td><td>Specifies the list of messages in the conversation. Each message should have a 'role' (either 'system', 'user', or 'assistant') and 'content' (the content of the message).</td></tr>
<tr><td><code>Model</code></td><td>System.Object</td><td>Specifies the model to use for generating completions. Default is 'gpt-4o-mini'.</td></tr>
<tr><td><code>FrequencyPenalty</code></td><td>System.Object</td><td>Specifies the frequency penalty to apply. Higher values will make the model avoid repeating the same completions. Default is not set.</td></tr>
<tr><td><code>LogitBias</code></td><td>System.Object</td><td>Specifies the logit bias to apply. Positive values will make the model more likely to generate completions similar to the examples in the training set, while negative values will make it less likely. Default is not set.</td></tr>
<tr><td><code>Logprobs</code></td><td>System.Object</td><td>Specifies whether to include log probabilities in the response. Default is not set.</td></tr>
<tr><td><code>TopLogprobs</code></td><td>System.Object</td><td>Specifies the number of log probabilities to include in the response. Default is not set.</td></tr>
<tr><td><code>MaxTokens</code></td><td>System.Object</td><td>Specifies the maximum number of tokens to generate in the response. Default is not set.</td></tr>
<tr><td><code>N</code></td><td>System.Object</td><td>Specifies the number of completions to generate. Default is not set.</td></tr>
<tr><td><code>PresencePenalty</code></td><td>System.Object</td><td>Specifies the presence penalty to apply. Higher values will make the model more cautious and avoid generating completions that overlap with the input. Default is not set.</td></tr>
<tr><td><code>ResponseFormat</code></td><td>System.Object</td><td>Specifies the format of the response. Valid values are 'auto', 'json', or 'text'. Default is not set.</td></tr>
<tr><td><code>Seed</code></td><td>System.Object</td><td>Specifies the random seed to use for generating completions. Default is not set.</td></tr>
<tr><td><code>Stop</code></td><td>System.Object</td><td>Specifies the stop sequence to use for generating completions. Default is not set.</td></tr>
<tr><td><code>Stream</code></td><td>System.Object</td><td>Specifies whether to enable streaming of the API response. Default is not set.</td></tr>
<tr><td><code>StreamOptions</code></td><td>System.Object</td><td>Specifies the options for streaming. Default is not set.</td></tr>
<tr><td><code>Temperature</code></td><td>System.Object</td><td>Specifies the temperature to use for generating completions. Higher values will make the output more random, while lower values will make it more deterministic. Default is not set.</td></tr>
<tr><td><code>TopP</code></td><td>System.Object</td><td>Specifies the top-p value to use for generating completions. Default is not set.</td></tr>
<tr><td><code>Tools</code></td><td>System.Object</td><td>Specifies the list of tools to use for generating completions. Default is not set.</td></tr>
<tr><td><code>ToolChoice</code></td><td>System.Object</td><td>Specifies the tool choice to use for generating completions. Default is not set.</td></tr>
<tr><td><code>ParallelToolCalls</code></td><td>System.Object</td><td></td></tr>
<tr><td><code>User</code></td><td>System.Object</td><td>Specifies the user for the conversation. Default is not set.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>$messages = @(
    @{
        'role' = 'user'
        'content' = 'Hello, how are you?'
    },
    @{
        'role' = 'assistant'
        'content' = 'I am doing well, thank you!'
    }
)</code></pre>
<p>Invoke-OAIChatCompletion -Messages $messages -Model 'gpt-4o' -MaxTokens 50

This example generates a chat-based completion using the 'gpt-4o' model with a maximum of 50 tokens.    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param(
        [Parameter(Mandatory)]
        $Messages,
        $Model = 'gpt-4o-mini',
        $FrequencyPenalty,
        $LogitBias,
        $Logprobs,
        $TopLogprobs,
        $MaxTokens,
        $N,
        $PresencePenalty,
        [ValidateSet('auto', 'json', 'text')]        
        $ResponseFormat,
        $Seed,
        $Stop,
        $Stream,
        $StreamOptions,
        [ValidateScript({ $_ -ge 0 -and $_ -le 2 })]
        $Temperature,
        [ValidateScript({ $_ -ge 0 -and $_ -le 1 })]
        $TopP,
        $Tools,
        $ToolChoice,
        $ParallelToolCalls,
        $User
    )
    
    $body = @{}

    if ($null -ne $Messages) { 
        $body['messages'] = @($Messages)
    }

    if ($null -ne $Model) { 
        $body['model'] = $Model
    }

    if ($null -ne $FrequencyPenalty) { 
        $body['frequency_penalty'] = $FrequencyPenalty
    }

    if ($null -ne $LogitBias) { 
        $body['logit_bias'] = $LogitBias
    }

    if ($null -ne $Logprobs) { 
        $body['logprobs'] = $Logprobs
    }

    if ($null -ne $TopLogprobs) { 
        $body['top_logprobs'] = $TopLogprobs
    }

    if ($null -ne $MaxTokens) { 
        $body['max_tokens'] = $MaxTokens
    }

    if ($null -ne $N) { 
        $body['n'] = $N
    }

    if ($null -ne $PresencePenalty) { 
        $body['presence_penalty'] = $PresencePenalty
    }

    if ($null -ne $ResponseFormat) { 
        # $body['response_format'] = $ResponseFormat
        if ($ResponseFormat -eq 'json') {
            $body['response_format'] = @{"type" = "json_object" }
        }

    }

    if ($null -ne $Seed) { 
        $body['seed'] = $Seed
    }

    if ($null -ne $Stop) { 
        $body['stop'] = $Stop
    }

    if ($null -ne $Stream) { 
        $body['stream'] = $Stream
    }

    if ($null -ne $StreamOptions) { 
        $body['stream_options'] = $StreamOptions
    }

    if ($null -ne $Temperature) { 
        $body['temperature'] = $Temperature
    }

    if ($null -ne $TopP) { 
        $body['top_p'] = $TopP
    }

    if ($null -ne $Tools) { 
        $body['tools'] = @($Tools)
    }

    if ($null -ne $ToolChoice) { 
        $body['tool_choice'] = $ToolChoice
    }

    if ($null -ne $ParallelToolCalls) { 
        $body['parallel_tool_calls'] = $ParallelToolCalls
    }

    if ($null -ne $User) { 
        $body['user'] = $User
    }

    <#
curl "https://openai-gpt-latest.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2024-02-15-preview" \
-H "Content-Type: application/json" \
-H "api-key: YOUR_API_KEY" \
-d "{
\"messages\": [],
\"max_tokens\": 800,
\"temperature\": 0.7,
\"frequency_penalty\": 0,
\"presence_penalty\": 0,
\"top_p\": 0.95,
\"stop\": null
}
    #>

    $url = $baseUrl + '/chat/completions'
    
    if ((Get-OAIProvider) -eq 'AzureOpenAI') {
        $AzOAISecrets = Get-AzOAISecrets

        $url = $baseUrl + '/deployments/' + $AzOAISecrets.deploymentName + '/chat/completions'
    }
    
    $Method = 'Post'

    Invoke-OAIBeta -Uri $url -Method $Method -Body $body
</code></pre>
</div>
<div class="page" id="InvokeOAIUploadFile">
<h2>Invoke-OAIUploadFile</h2>
<p><strong>Page:</strong> 58</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Uploads a file to a specified URL using the OpenAI API.</p>
<h3>Description</h3>
<p>The Invoke-OAIUploadFile function uploads a file to a specified URL using the OpenAI API. It supports uploading files for fine-tuning or for use with assistants.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>Path</code></td><td>System.Object</td><td>Specifies the path of the file to upload. This parameter accepts pipeline input by property name.</td></tr>
<tr><td><code>Purpose</code></td><td>System.Object</td><td>Specifies the purpose of the file upload. Valid values are 'fine-tune' and 'assistants'. The default value is 'assistants'.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Invoke-OAIUploadFile -Path 'C:\Files\my_file.txt' -Purpose 'fine-tune'
Uploads the file 'my_file.txt' for fine-tuning using the OpenAI API.</code></pre>
<p>    </p>
<pre><code class='language-powershell'>Get-ChildItem 'C:\Files' | Invoke-OAIUploadFile -Purpose 'assistants'
Uploads all files in the 'C:\Files' directory for use with assistants using the OpenAI API.</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param (
        [Parameter(ValueFromPipelineByPropertyName)]
        [Alias('FullName')]
        $Path,
        [ValidateSet('fine-tune', 'assistants', 'vision')]        
        $Purpose = 'assistants'
    )
    
    Process {
        $url = $baseUrl + '/files'
        $Method = 'POST'

        $FormData = Get-MultipartFormData -FilePath $Path -Purpose $Purpose

        Write-Verbose "Uploading file '$($Path)' with purpose '$Purpose' ..."
        Invoke-OAIBeta -Uri $url -Method $Method -Body $FormData['Stream'] -ContentType $FormData['ContentType']

        $FormData['Stream'].Close()
    }
</code></pre>
</div>
<div class="page" id="InvokeQuickChat">
<h2>Invoke-QuickChat</h2>
<p><strong>Page:</strong> 59</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Invokes a quick chat session with an AI assistant.</p>
<h3>Description</h3>
<p>This function allows you to interact with an AI assistant by asking questions and receiving responses in a chat-like manner.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>AssistantId</code></td><td>System.Object</td><td>Specifies the ID of the assistant to interact with.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>$assistant = New-OAIAssistant -Name 'Math Tutor'
Invoke-QuickChat $assistant.id</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param(
        [Parameter(ValueFromPipelineByPropertyName)]
        [Alias('id')]
        $AssistantId
    )

    End {
        if (!(Test-OAIAssistantId $AssistantId)) {
            Write-Error "Assistant with Id $AssistantId not found"
            return
        }

        $assistant = Get-OAIAssistantItem -AssistantId $AssistantId
        $assistantName = $assistant.Name
        if ($null -eq $assistantName) {
            $assistantName = 'Assistant'
        }

        "Hello, I am an $($assistantName). Type 'Exit' to exit."

        while ($true) {
            #$userInput = Read-Host "Ask $($assistantName) a question"
            $userInput = Read-Host "Question"
    
            if ($userInput -eq 'Exit') {
                break
            }

            if (!$threadQuery) {
                $threadQuery = New-OAIThreadQuery -Assistant $assistant -UserInput $userInput
            }
            else {
                $submitResponse = Submit-OAIMessage -Assistant $assistant -Thread $threadQuery.Thread -UserInput $userInput

                $threadQuery.Run = $submitResponse.Run
                $threadQuery.Message = $submitResponse.Message
            }

            $null = Wait-OAIOnRun -Thread $threadQuery.Thread -Run $threadQuery.Run

            $message = Get-OAIMessage -ThreadId $threadQuery.Thread.Id -Order asc
            $message.data[-1].content.text.value
        }
    }
</code></pre>
</div>
<div class="page" id="InvokeSimpleQuestion">
<h2>Invoke-SimpleQuestion</h2>
<p><strong>Page:</strong> 60</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Invokes a simple question to an AI assistant.</p>
<h3>Description</h3>
<p>The Invoke-SimpleQuestion function is used to ask a simple question to an AI assistant. It requires the AssistantId parameter to specify the ID of the assistant to interact with. The function sends the question to the assistant, waits for the response, and returns the assistant's answer.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>Question</code></td><td>System.Object</td><td>The question to ask the AI assistant.</td></tr>
<tr><td><code>AssistantId</code></td><td>System.Object</td><td>The ID of the AI assistant to interact with.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>$assistant = New-OAIAssistant
Invoke-SimpleQuestion -Question "What is the meaning of life?" -AssistantId $assistant.Id
Remove-OAIAssistant -Id $assistant.Id</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param(
        [Parameter(Mandatory)]
        $Question,
        [Parameter(ValueFromPipelineByPropertyName)]
        [Alias('id')]
        $AssistantId
    )

    Begin {
        $assistant = @()
    }

    Process {
        if($null -eq $AssistantId) {
            Write-Error "AssistantId is required"
            return
        }

        if (!(Test-OAIAssistantId $AssistantId)) {
            Write-Error "Assistant with Id $AssistantId not found"
            return
        }

        $assistant += Get-OAIAssistantItem -AssistantId $AssistantId
    }

    End {
        if($null -eq $assistant) {
            return
        }

        foreach ($assistantItem in $assistant) {
            $assistantName = $assistantItem.Name
            if ($null -eq $assistantName) {
                $assistantName = 'Assistant'
            }

            Write-Host "Asking the question: " -NoNewline
            Write-Host -ForegroundColor Yellow $Question

            $queryResult = New-OAIThreadQuery -UserInput $Question -Assistant $assistantItem
            $null = Wait-OAIOnRun -Run $queryResult.Run -Thread $queryResult.Thread
            $messages = Get-OAIMessage -ThreadId $queryResult.Thread.Id
            $messages.data[0].content.text.value
        }
    }
</code></pre>
</div>
<div class="page" id="NewChatRequestAssistantMessage">
<h2>New-ChatRequestAssistantMessage</h2>
<p><strong>Page:</strong> 61</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Creates a new chat request assistant message.</p>
<h3>Description</h3>
<p>The New-ChatRequestAssistantMessage function creates a new chat request assistant message with the specified user request.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>userRequest</code></td><td>System.Object</td><td>The user request to be included in the assistant message.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>$message = New-ChatRequestAssistantMessage -userRequest "Hello, I need assistance with my account."
$message
# Output: @{role='assistant'; content='Hello, I need assistance with my account.'}</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param(
        [Parameter(Mandatory)]
        $userRequest
    )

    @{
        'role'    = 'assistant'
        'content' = $userRequest
    }
</code></pre>
</div>
<div class="page" id="NewChatRequestSystemMessage">
<h2>New-ChatRequestSystemMessage</h2>
<p><strong>Page:</strong> 62</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Creates a new system message for a chat request.</p>
<h3>Description</h3>
<p>The New-ChatRequestSystemMessage function creates a new system message for a chat request. It takes the user request as input and returns a hashtable containing the role and content of the system message.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>userRequest</code></td><td>System.Object</td><td>The user request for the chat.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>$userRequest = "Please wait while we connect you to an agent."
New-ChatRequestSystemMessage -userRequest $userRequest</code></pre>
<p>This example creates a new system message with the specified user request.    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param(
        [Parameter(Mandatory)]
        $userRequest
    )

    @{
        'role'    = 'system'
        'content' = $userRequest
    }
</code></pre>
</div>
<div class="page" id="NewChatRequestToolMessage">
<h2>New-ChatRequestToolMessage</h2>
<p><strong>Page:</strong> 63</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Creates a new chat request tool message.</p>
<h3>Description</h3>
<p>The New-ChatRequestToolMessage function creates a new chat request tool message with the specified parameters.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>toolCallId</code></td><td>System.Object</td><td>The ID of the tool call.</td></tr>
<tr><td><code>toolFunctionName</code></td><td>System.Object</td><td>The name of the tool function.</td></tr>
<tr><td><code>content</code></td><td>System.Object</td><td>The content of the tool message.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>New-ChatRequestToolMessage -toolCallId 123 -toolFunctionName "MyTool" -content "Hello, world!"</code></pre>
<p>This example creates a new chat request tool message with the tool call ID 123, tool function name "MyTool", and content "Hello, world!".    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param (
        [Parameter(Mandatory)]
        $toolCallId,
        [Parameter(Mandatory)]
        $toolFunctionName,
        [Parameter(Mandatory)]
        $content        
    )
  
    @{
        role         = 'tool'
        tool_call_id = $toolCallId
        name         = $toolFunctionName
        content      = $content | Out-String
    }
</code></pre>
</div>
<div class="page" id="NewChatRequestUserMessage">
<h2>New-ChatRequestUserMessage</h2>
<p><strong>Page:</strong> 64</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Creates a new user message for a chat request.</p>
<h3>Description</h3>
<p>The New-ChatRequestUserMessage function creates a new user message for a chat request. It takes a user request as input and returns a hashtable containing the role and content of the message.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>userRequest</code></td><td>System.Object</td><td>The user request to be included in the message.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>$userRequest = "Hello, I need assistance with my account."
New-ChatRequestUserMessage -userRequest $userRequest
# Returns:
# @{
#     'role'    = 'user'
#     'content' = 'Hello, I need assistance with my account.'
# }</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param(
        [Parameter(Mandatory )]
        $userRequest
    )

    @{
        'role'    = 'user'
        'content' = $userRequest
    }
</code></pre>
</div>
<div class="page" id="NewOAIAssistant">
<h2>New-OAIAssistant</h2>
<p><strong>Page:</strong> 65</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Creates a new OpenAI Assistant.</p>
<h3>Description</h3>
<p>The New-OAIAssistant function is used to create a new OpenAI Assistant. It sends a POST request to the OpenAI API to create the assistant with the specified parameters.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>Name</code></td><td>System.Object</td><td>The name of the assistant.</td></tr>
<tr><td><code>Instructions</code></td><td>System.Object</td><td>The instructions to provide to the assistant.</td></tr>
<tr><td><code>Description</code></td><td>System.Object</td><td>The description of the assistant.</td></tr>
<tr><td><code>Tools</code></td><td>System.Object</td><td>The tools used by the assistant. There can be a maximum of 128 tools per assistant. Tools can be of types code_interpreter, file_search, or function.</td></tr>
<tr><td><code>ToolResources</code></td><td>System.Object</td><td>The resources required by the tools used by the assistant. The resources are specific to the type of tool. For example, the code_interpreter tool requires a list of file IDs, while the file_search tool requires a list of vector store IDs.</td></tr>
<tr><td><code>Model</code></td><td>System.Object</td><td>The model to use for the assistant. Valid values are 'gpt-4', 'gpt-3.5-turbo', 'gpt-3.5-turbo-16k', 'gpt-4-turbo-preview', 'gpt-4-1106-preview', and 'gpt-3.5-turbo-1106'. The default value is 'gpt-3.5-turbo'.</td></tr>
<tr><td><code>Metadata</code></td><td>System.Object</td><td>The metadata associated with the assistant.</td></tr>
<tr><td><code>Temperature</code></td><td>System.Object</td><td>The temperature parameter for generating responses. Must be a value between 0 and 2.</td></tr>
<tr><td><code>TopP</code></td><td>System.Object</td><td>The top-p parameter for generating responses. Must be a value between 0 and 1.</td></tr>
<tr><td><code>ResponseFormat</code></td><td>System.Object</td><td>The format of the response. Valid values are 'auto', 'json', and 'text'. The default value is 'auto'.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>New-OAIAssistant -Name 'MyAssistant' -Instructions 'How can I help you?' -Description 'An assistant to answer questions' -Tools 'Calculator' -ToolResources 'https://example.com/calculator' -Model 'gpt-3.5-turbo' -Metadata @{ 'version' = '1.0' } -Temperature 0.8 -TopP 0.5 -ResponseFormat 'json'</code></pre>
<p>This example creates a new OpenAI Assistant named 'MyAssistant' with the specified parameters.    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param(
        $Name,
        $Instructions,
        $Description,
        $Tools,
        $ToolResources,
        $Model = 'gpt-4o-mini',
        $Metadata,
        [ValidateScript({ $_ -ge 0 -and $_ -le 2 })]
        $Temperature = $null,
        [ValidateScript({ $_ -ge 0 -and $_ -le 1 })]
        $TopP = $null,
        [ValidateSet('auto', 'json', 'text')]
        $ResponseFormat = 'auto'
    )
    
    $url = $baseUrl + '/assistants'
    $Method = 'Post'
    
    $body = @{
        name         = $Name
        instructions = $Instructions
        model        = $Model
    }

    if ($Description) {
        $body['description'] = $Description        
    }

    if ($Tools) {
        $body['tools'] = @($Tools)
    }

    if ($ToolResources) {
        $body['tool_resources'] = $ToolResources
    }

    if ($Metadata) {
        $body['metadata'] = $Metadata        
    }

    if ($Temperature) {
        $body['temperature'] = $Temperature
    }

    if ($TopP) {
        $body['top_p'] = $TopP
    }

    if ($ResponseFormat -eq 'json') {
        $body['response_format'] = @{ 'type' = 'json_object' }
    }
    elseif ($ResponseFormat -eq 'text') {
        $body['response_format'] = @{ 'type' = 'text' }
    }

    Invoke-OAIBeta -Uri $url -Method $Method -Body $body
</code></pre>
</div>
<div class="page" id="NewOAIAssistantWithVectorStore">
<h2>New-OAIAssistantWithVectorStore</h2>
<p><strong>Page:</strong> 66</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> 
New-OAIAssistantWithVectorStore [-Path] <Object> [<CommonParameters>]
</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>Path</code></td><td>System.Object</td><td></td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param(   
        [Parameter(Mandatory)]     
        $Path
    )

    $vectorStore = Add-OAIVectorStore -Path $Path

    $assistantParams = @{
        Model         = "gpt-4-turbo-preview"
        Tools         = Enable-OAIFileSearchTool
        ToolResources = @{
            file_search = @{
                vector_store_ids = @($vectorStore.id)
            }
        }
    }

    Write-Host "Creating assistant..." -ForegroundColor Cyan
    $Assistant = New-OAIAssistant @assistantParams

    $vectorStoreName = "Vector Store for $($Assistant.id)"
    $vectorStore = Update-OAIVectorStore -VectorStoreId $vectorStore.id -Name $vectorStoreName
    
    [PSCustomObject]@{
        Assistant   = $Assistant
        VectorStore = $vectorStore
    }
</code></pre>
</div>
<div class="page" id="NewOAIChatMessage">
<h2>New-OAIChatMessage</h2>
<p><strong>Page:</strong> 67</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Creates a new chat message object.</p>
<h3>Description</h3>
<p>The New-OAIChatMessage function creates a new chat message object with the specified content and role.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>Content</code></td><td>System.Object</td><td>The content of the chat message.</td></tr>
<tr><td><code>Role</code></td><td>System.Object</td><td>The role of the chat message. Valid values are 'system', 'user', and 'assistant'. The default value is 'user'.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>New-OAIChatMessage -Content "Hello, how can I assist you?" -Role 'assistant'
Creates a new chat message object with the content "Hello, how can I assist you?" and the role 'assistant'.</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param(
        $Content,
        [ValidateSet('system', 'user', 'assistant')]
        $Role = 'user'       
    )

    [PSCustomObject]@{
        role    = $Role
        content = $Content
    }
</code></pre>
</div>
<div class="page" id="NewOAIMessage">
<h2>New-OAIMessage</h2>
<p><strong>Page:</strong> 68</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Creates a new message for a specified thread in the OpenAI API.</p>
<h3>Description</h3>
<p>The New-OAIMessage function creates a new message for a specified thread in the OpenAI API. It allows you to specify the thread ID, role, content, attachments, and metadata for the message.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>ThreadId</code></td><td>System.Object</td><td>The ID of the thread to which the message belongs.</td></tr>
<tr><td><code>Role</code></td><td>System.Object</td><td>The role of the message. Valid values are 'user' and 'assistant'.</td></tr>
<tr><td><code>Content</code></td><td>System.Object</td><td>The content of the message.</td></tr>
<tr><td><code>Attachments</code></td><td>System.Object</td><td>Optional. Any attachments to include with the message.</td></tr>
<tr><td><code>Metadata</code></td><td>System.Object</td><td>Optional. Any metadata to include with the message.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>New-OAIMessage -ThreadId "12345" -Role "user" -Content "Hello, how can I help you?"</code></pre>
<p>This example creates a new user message with the content "Hello, how can I help you?" for the thread with ID "12345".    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param(
        [Parameter(ValueFromPipelineByPropertyName)]
        [Alias('Id')]
        $ThreadId,
        [Parameter(Mandatory)]
        [ValidateSet('user', 'assistant')]
        $Role,
        [Parameter(Mandatory)]
        $Content,
        $Attachments,
        $Metadata
    )

    Process {
        $url = $baseUrl + "/threads/$ThreadId/messages"
        $Method = 'Post'

        $body = @{
            role    = $Role
            content = $Content
        }

        if ($Attachments) {
            $body.attachments = $Attachments
        }

        if ($Metadata) {
            $body.metadata = $Metadata
        }

        Invoke-OAIBeta -Uri $url -Method $Method -Body $body
    }
</code></pre>
</div>
<div class="page" id="NewOAIRun">
<h2>New-OAIRun</h2>
<p><strong>Page:</strong> 69</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> 
New-OAIRun [[-ThreadId] <Object>] [[-AssistantId] <Object>] [[-Model] <Object>] [[-Instructions] <Object>] [[-AdditionalInstructions] <Object>] [[-AdditionalMessages] <Object>] [[-Tools] <Object>] [[-Metadata] <Object>] [[-Temperature] <Object>] [[-TopP] <Object>] [[-MaxPromptTokens] <Object>] [[-MaxCompletionTokens] <Object>] [[-TruncationStrategy] <Object>] [[-ToolChoice] <Object>] [[-ResponseFormat] <Object>] [-Stream] [<CommonParameters>]
</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>ThreadId</code></td><td>System.Object</td><td></td></tr>
<tr><td><code>AssistantId</code></td><td>System.Object</td><td></td></tr>
<tr><td><code>Model</code></td><td>System.Object</td><td></td></tr>
<tr><td><code>Instructions</code></td><td>System.Object</td><td></td></tr>
<tr><td><code>AdditionalInstructions</code></td><td>System.Object</td><td></td></tr>
<tr><td><code>AdditionalMessages</code></td><td>System.Object</td><td></td></tr>
<tr><td><code>Tools</code></td><td>System.Object</td><td></td></tr>
<tr><td><code>Metadata</code></td><td>System.Object</td><td></td></tr>
<tr><td><code>Temperature</code></td><td>System.Object</td><td></td></tr>
<tr><td><code>TopP</code></td><td>System.Object</td><td></td></tr>
<tr><td><code>Stream</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>MaxPromptTokens</code></td><td>System.Object</td><td></td></tr>
<tr><td><code>MaxCompletionTokens</code></td><td>System.Object</td><td></td></tr>
<tr><td><code>TruncationStrategy</code></td><td>System.Object</td><td></td></tr>
<tr><td><code>ToolChoice</code></td><td>System.Object</td><td></td></tr>
<tr><td><code>ResponseFormat</code></td><td>System.Object</td><td></td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param(
        [Parameter(ValueFromPipelineByPropertyName)]
        [Alias('thread_id')]
        $ThreadId,
        [Parameter(ValueFromPipelineByPropertyName)]
        [Alias('id')]
        $AssistantId,
        $Model,
        $Instructions,
        $AdditionalInstructions,
        $AdditionalMessages,
        $Tools,
        $Metadata,
        $Temperature,
        $TopP,
        [Switch]$Stream,
        $MaxPromptTokens,
        $MaxCompletionTokens,
        $TruncationStrategy,
        $ToolChoice,
        [ValidateSet('auto', 'json', 'text')]
        $ResponseFormat
    )

    Process {
        if ($null -eq $ThreadId -or $null -eq $AssistantId) {
            break
        }

        $url = $baseUrl + "/threads/$ThreadId/runs"
        $Method = 'Post'

        $body = @{
            assistant_id = $AssistantId
        }

        if ($null -ne $Model) {
            $body['model'] = $Model
        }

        if ($null -ne $Instructions) {
            $body['instructions'] = $Instructions
        }

        if ($null -ne $AdditionalInstructions) {
            $body['additional_instructions'] = $AdditionalInstructions
        }

        if ($null -ne $AdditionalMessages) {
            $body['additional_messages'] = @($AdditionalMessages)
        }

        if($null -ne $Tools) {
            $body['tools'] = @($Tools)
        }

        if ($null -ne $Metadata) {
            $body['metadata'] = $Metadata         
        }

        if ($null -ne $Temperature) {
            $body['temperature'] = $Temperature
        }

        if ($null -ne $TopP) {
            $body['top_p'] = $TopP
        }

        if ($Stream) {
            $body['stream'] = $Stream
        }

        if ($null -ne $MaxPromptTokens) {
            $body['max_prompt_tokens'] = $MaxPromptTokens
        }

        if ($null -ne $MaxCompletionTokens) {
            $body['max_completion_tokens'] = $MaxCompletionTokens
        }

        if ($null -ne $TruncationStrategy) {
            $body['truncation_strategy'] = $TruncationStrategy
        }

        if ($null -ne $ToolChoice) {
            $body['tool_choice'] = $ToolChoice
        }

        if ($null -ne $ResponseFormat) {
            $body['response_format'] = $ResponseFormat
        }

        Invoke-OAIBeta -Uri $url -Method $Method -Body $body
    }   
</code></pre>
</div>
<div class="page" id="NewOAIThread">
<h2>New-OAIThread</h2>
<p><strong>Page:</strong> 70</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Creates a new thread in the OpenAI API.</p>
<h3>Description</h3>
<p>The New-OAIThread function sends a POST request to the OpenAI API to create a new thread. It takes in the following parameters:
- messages: An array of messages to be included in the thread.
- tool_resources: (Optional) Additional tool resources to be used in the thread.
- metadata: (Optional) Additional metadata to be associated with the thread.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>Messages</code></td><td>System.Object[]</td><td>Specifies an array of messages to be included in the thread.</td></tr>
<tr><td><code>ToolResources</code></td><td>System.Object</td><td></td></tr>
<tr><td><code>Metadata</code></td><td>System.Object</td><td>Specifies additional metadata to be associated with the thread. This parameter is optional.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>$messages = @(
    @{
        role = 'user'
        content = 'You are a helpful AI assistant.'
    },
    @{
        role = 'user'
        content = 'How can I create a new thread?'
    }
)</code></pre>
<p>New-OAIThread -messages $messages    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param(
        [Object[]]$Messages,
        $ToolResources,
        $Metadata
    )

    $url = $baseUrl + '/threads'
    $Method = 'Post'

    # $body = (Get-OAIProvider) -eq 'OpenAI' ? @{
    #     messages       = $Messages
    #     tool_resources = $ToolResources
    #     metadata       = $Metadata
    # } : ''
    
    if ((Get-OAIProvider) -eq 'OpenAI') {
        $body = @{
            messages       = $Messages
            tool_resources = $ToolResources
            metadata       = $Metadata
        }
    }
    else {
        $body = ''
    }
    
    Invoke-OAIBeta -Uri $url -Method $Method -Body $body
</code></pre>
</div>
<div class="page" id="NewOAIThreadAndRun">
<h2>New-OAIThreadAndRun</h2>
<p><strong>Page:</strong> 71</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Creates a new OpenAI thread and runs it.</p>
<h3>Description</h3>
<p>The New-OAIThreadAndRun function creates a new thread and runs it using the OpenAI API. It allows you to specify various parameters such as the assistant ID, thread, model, instructions, tools, tool resources, metadata, temperature, top-p, stress, max prompt tokens, max completion tokens, truncation strategy, tool choices, and response format.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>AssistantId</code></td><td>System.Object</td><td>The ID of the assistant to use for the thread.</td></tr>
<tr><td><code>Thread</code></td><td>System.Object</td><td>The thread to be used for the conversation.</td></tr>
<tr><td><code>Model</code></td><td>System.Object</td><td>The model to use for generating responses.</td></tr>
<tr><td><code>Instructions</code></td><td>System.Object</td><td>The instructions to provide to the model.</td></tr>
<tr><td><code>Tools</code></td><td>System.Object</td><td>The tools to be used during the conversation.</td></tr>
<tr><td><code>ToolResources</code></td><td>System.Object</td><td>The resources required by the tools.</td></tr>
<tr><td><code>Metadata</code></td><td>System.Object</td><td>Additional metadata to include with the request.</td></tr>
<tr><td><code>Temperature</code></td><td>System.Object</td><td>The temperature parameter controls the randomness of the model's output. Higher values (e.g., 0.8) make the output more random, while lower values (e.g., 0.2) make it more focused and deterministic.</td></tr>
<tr><td><code>TopP</code></td><td>System.Object</td><td>The top-p parameter controls the diversity of the model's output. It specifies the cumulative probability threshold for generating tokens. Higher values (e.g., 0.9) result in more diverse output, while lower values (e.g., 0.3) make it more focused.</td></tr>
<tr><td><code>Stress</code></td><td>System.Object</td><td>The stress parameter controls how much the model is "pushed" to generate a response. Higher values (e.g., 0.8) make the model more likely to generate a response, even if it's not confident. Lower values (e.g., 0.2) make it more cautious.</td></tr>
<tr><td><code>MaxPromptTokens</code></td><td>System.Object</td><td>The maximum number of tokens allowed in the prompt.</td></tr>
<tr><td><code>MaxCompletionTokens</code></td><td>System.Object</td><td>The maximum number of tokens allowed in the completion.</td></tr>
<tr><td><code>TruncationStrategy</code></td><td>System.Object</td><td>The truncation strategy to use when the input exceeds the maximum token limit.</td></tr>
<tr><td><code>ToolChoices</code></td><td>System.Object</td><td>The choices for the tools to be used during the conversation.</td></tr>
<tr><td><code>ResponseFormat</code></td><td>System.Object</td><td>The format in which the response should be returned. Valid values are 'auto', 'json', and 'text'.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>New-OAIThreadAndRun -AssistantId 'assistant-123' -Thread 'Hello' -Model 'gpt-3.5-turbo' -Instructions 'Translate the following English text to French: "Hello, how are you?"' -Tools 'translation' -ToolResources @{ translation = @{ source_language = 'en' ; target_language = 'fr' } } -Temperature 0.8 -TopP 0.9 -Stress 0.5 -MaxPromptTokens 100 -MaxCompletionTokens 50 -TruncationStrategy 'longest_first' -ToolChoices @{ translation = 'translation' } -ResponseFormat 'json'</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    param (
        [Parameter(Mandatory)]
        $AssistantId,
        $Thread,
        $Model,
        $Instructions,
        $Tools,
        $ToolResources,
        $Metadata,
        [ValidateScript({ $_ -ge 0 -and $_ -le 2 })]
        $Temperature,
        [ValidateScript({ $_ -ge 0 -and $_ -le 1 })]
        $TopP,
        $Stress,
        $MaxPromptTokens,
        $MaxCompletionTokens,
        $TruncationStrategy,
        $ToolChoices,
        [ValidateSet('auto', 'json', 'text')]
        $ResponseFormat
    )

    $body = @{
        assistant_id = $AssistantId
    }

    if($null -ne $Thread) {
        $body.thread = $Thread
    }

    if($null -ne $Model) {
        $body.model = $Model
    }
     
    if($null -ne $Instructions) {
        $body.instructions = $Instructions
    }

    if($null -ne $Tools) {
        $body.tools = $Tools
    }

    if($null -ne $ToolResources) {
        $body.tool_resources = $ToolResources
    }

    if($null -ne $Metadata) {
        $body.metadata = $Metadata
    }

    if($null -ne $Temperature) {
        $body.temperature = $Temperature
    }

    if($null -ne $TopP) {
        $body.top_p = $TopP
    }

    if($null -ne $Stress) {
        $body.stress = $Stress
    }

    if($null -ne $MaxPromptTokens) {
        $body.max_prompt_tokens = $MaxPromptTokens
    }

    if($null -ne $MaxCompletionTokens) {
        $body.max_completion_tokens = $MaxCompletionTokens
    }

    if($null -ne $TruncationStrategy) {
        $body.truncation_strategy = $TruncationStrategy
    }

    if($null -ne $ToolChoices) {
        $body.tool_choices = $ToolChoices
    }

    if($null -ne $ResponseFormat) {
        $body.response_format = $ResponseFormat
    }

    $url = $baseUrl + '/threads/runs'
    $Method = 'Post'

    Invoke-OAIBeta -Uri $url -Method $Method -Body $body
</code></pre>
</div>
<div class="page" id="NewOAIThreadQuery">
<h2>New-OAIThreadQuery</h2>
<p><strong>Page:</strong> 72</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Creates a new thread query.</p>
<h3>Description</h3>
<p>The New-OAIThreadQuery function creates a new thread query by invoking the New-OAIThread cmdlet and submitting a message using the Submit-OAIMessage cmdlet.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>UserInput</code></td><td>System.Object</td><td>The user input to be included in the query.</td></tr>
<tr><td><code>Assistant</code></td><td>System.Object</td><td>The assistant to be used for the query.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>New-OAIThreadQuery -UserInput "Hello" -Assistant $assistant</code></pre>
<p>This example creates a new thread query with the user input "Hello" and the specified assistant.    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param(
        [Parameter(Mandatory)]
        $UserInput,
        [Parameter(Mandatory)]
        $Assistant
    )

    $thread = New-OAIThread
    
    $submitResult = Submit-OAIMessage -Assistant $assistant -Thread $thread -UserInput $UserInput

    [PSCustomobject]@{
        Thread  = $thread
        Run     = $submitResult.run
        Message = $submitResult.message
    }
</code></pre>
</div>
<div class="page" id="NewOAIVectorStore">
<h2>New-OAIVectorStore</h2>
<p><strong>Page:</strong> 73</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Creates a new vector store in OpenAI.</p>
<h3>Description</h3>
<p>The New-OAIVectorStore function creates a new vector store in OpenAI using the OpenAI API. It allows you to specify the name, file IDs, expiration time, and metadata for the vector store.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>Name</code></td><td>System.Object</td><td>The name of the vector store.</td></tr>
<tr><td><code>FileIds</code></td><td>System.String[]</td><td>An array of file IDs to associate with the vector store.</td></tr>
<tr><td><code>ExpiresAfter</code></td><td>System.Object</td><td>The expiration time for the vector store. After this time, the vector store will be deleted. 
"expires_after": { "anchor": "last_active_at", "days": 7 }</td></tr>
<tr><td><code>Metadata</code></td><td>System.Collections.Hashtable</td><td>A hashtable containing additional metadata for the vector store.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>New-OAIVectorStore -Name "MyVectorStore" -FileIds "file1", "file2" -ExpiresAfter (Get-Date).AddDays(7) -Metadata @{ "key1" = "value1"; "key2" = "value2" }</code></pre>
<p>This example creates a new vector store named "MyVectorStore" with two file IDs, an expiration time of 7 days from the current date, and additional metadata.    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param (
        [Parameter(ValueFromPipeline)]
        $Name,
        [string[]]$FileIds,
        $ExpiresAfter,
        [hashtable]$Metadata
    )

    process {
        $body = @{}
            
        if ($Name) {
            $body.name = $Name
        }

        if ($FileIds) {
            $body.file_ids = $FileIds
        }

        if ($ExpiresAfter) {
            $body.expires_after = $ExpiresAfter
        }

        if ($Metadata) {
            $body.metadata = $Metadata
        }

        $params = @{
            Uri    = $baseUrl + "/vector_stores"
            Method = "Post"
            Body   = $body
        }

        $response = Invoke-OAIBeta @params
        $response
    }
</code></pre>
</div>
<div class="page" id="NewOAIVectorStoreFile">
<h2>New-OAIVectorStoreFile</h2>
<p><strong>Page:</strong> 74</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Creates a new file in the specified vector store.</p>
<h3>Description</h3>
<p>The New-OAIVectorStoreFile function creates a new file in the specified vector store. It takes the VectorStoreId and FileIds as mandatory parameters. The function sends a POST request to the specified vector store's files endpoint to create the file.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>VectorStoreId</code></td><td>System.Object</td><td>The ID of the vector store where the file will be created.</td></tr>
<tr><td><code>FileIds</code></td><td>System.Object</td><td>The ID(s) of the file(s) to be created in the vector store. This parameter accepts pipeline input by property name.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>New-OAIVectorStoreFile -VectorStoreId "12345" -FileIds "file1", "file2"</code></pre>
<p>This example creates two files with IDs "file1" and "file2" in the vector store with ID "12345".    </p>
<pre><code class='language-powershell'>dir *.md | Invoke-OAIUploadFile | New-OAIVectorStoreFile -VectorStoreId "12345"</code></pre>
<p>This example uploads all Markdown files in the current directory to OpenAI and creates files in the vector store with ID "12345" for each uploaded file.    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    param(
        [Parameter(Mandatory)]
        $VectorStoreId,
        [Parameter(Mandatory, ValueFromPipelineByPropertyName)]
        [Alias('id')]
        $FileIds
    )

    Begin {
        $params = @{
            Uri    = $baseUrl + "/vector_stores/$VectorStoreId/files"
            Method = "Post"
        }

        $targetFileIds = @()
    }

    Process {
        $targetFileIds += $FileIds
    }

    End {
        foreach ($fileId in $targetFileIds) {    
            $params.Body = @{file_id = $FileId }
            Invoke-OAIBeta @params
        }
    }
</code></pre>
</div>
<div class="page" id="NewOAIVectorStoreFileBatch">
<h2>New-OAIVectorStoreFileBatch</h2>
<p><strong>Page:</strong> 75</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> 
New-OAIVectorStoreFileBatch [-VectorStoreId] <Object> [-FileIds] <Object> [<CommonParameters>]
</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>VectorStoreId</code></td><td>System.Object</td><td></td></tr>
<tr><td><code>FileIds</code></td><td>System.Object</td><td></td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param(
        [Parameter(Mandatory)]
        $VectorStoreId,
        [Parameter(Mandatory)]
        $FileIds
    )
    
    $params = @{
        Uri    = $baseUrl + "/vector_stores/$VectorStoreId/file_batches"
        Method = "Post"
        Body   = @{file_ids = $FileIds }
    }

    Invoke-OAIBeta @params
</code></pre>
</div>
<div class="page" id="OutOAIMessages">
<h2>Out-OAIMessages</h2>
<p><strong>Page:</strong> 76</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Outputs messages with roles and content.</p>
<h3>Description</h3>
<p>The Out-OAIMessages function is used to output messages with roles and content. It accepts an array of messages and an optional switch parameter to exclude the header.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>Messages</code></td><td>System.Object</td><td>Specifies the array of messages to be output.</td></tr>
<tr><td><code>NoHeader</code></td><td>System.Management.Automation.SwitchParameter</td><td>Specifies whether to exclude the header. By default, the header is included.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>$messages = @(
    [PSCustomObject]@{
        role = "Info"
        content = [PSCustomObject]@{
            text = [PSCustomObject]@{
                value = "This is an informational message."
            }
        }
    },
    [PSCustomObject]@{
        role = "Warning"
        content = [PSCustomObject]@{
            text = [PSCustomObject]@{
                value = "This is a warning message."
            }
        }
    }
)</code></pre>
<p>Out-OAIMessages -Messages $messages

This example demonstrates how to use the Out-OAIMessages function to output messages.    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param(
        $Messages,
        [Switch]$NoHeader
    )

    if(!$NoHeader) {
        Write-Host "# Messages"
    }

    foreach ($m in $Messages) {
        Write-Host "$($m.role): " -NoNewline -ForegroundColor Green
        Write-Host "$($m.content.text.value)"
    }
</code></pre>
</div>
<div class="page" id="RemoveOAIAssistant">
<h2>Remove-OAIAssistant</h2>
<p><strong>Page:</strong> 77</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Removes an OAI Assistant.</p>
<h3>Description</h3>
<p>The Remove-OAIAssistant function is used to remove an OAI Assistant by its ID.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>Id</code></td><td>System.Object</td><td>The ID of the OAI Assistant to be removed.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Remove-OAIAssistant -Id "assistant123"
Removes the OAI Assistant with the ID "assistant123".</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param(
        [Parameter(ValuefromPipelinebyPropertyName)]
        $Id
    )
  
    # Needs a confirmation and whatif etc
    Process {
        $url = $baseUrl + "/assistants/$Id"
        $Method = 'Delete'
        Invoke-OAIBeta -Uri $url -Method $Method
    }
</code></pre>
</div>
<div class="page" id="RemoveOAIFile">
<h2>Remove-OAIFile</h2>
<p><strong>Page:</strong> 78</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Removes a file from the OpenAPI server.</p>
<h3>Description</h3>
<p>The Remove-OAIFile function removes a file from the OpenAPI server using the specified file ID.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>id</code></td><td>System.Object</td><td>The ID of the file to be removed.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Remove-OAIFile -id "12345"</code></pre>
<p>This example removes the file with the ID "12345" from the OpenAPI server.    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param(
        [Parameter(ValueFromPipelineByPropertyName)]
        $id
    )

    Process {
        $url = $baseUrl + "/files/$id"
        $Method = 'Delete'

        Invoke-OAIBeta -Uri $url -Method $Method
    }
</code></pre>
</div>
<div class="page" id="RemoveOAIMessage">
<h2>Remove-OAIMessage</h2>
<p><strong>Page:</strong> 79</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> 
Remove-OAIMessage [[-ThreadId] <Object>] [[-MessageId] <Object>] [<CommonParameters>]
</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>ThreadId</code></td><td>System.Object</td><td></td></tr>
<tr><td><code>MessageId</code></td><td>System.Object</td><td></td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    param(
        [Parameter(ValueFromPipelineByPropertyName)]
        [Alias('thread_id')]        
        $ThreadId,
        [Parameter(ValueFromPipelineByPropertyName)]
        [Alias('id')]
        $MessageId
    )

    Process {

        if ($null -eq $ThreadId -or $null -eq $MessageId) {
            return
        }

        $Method = 'Delete'
        $url = $baseUrl + "/threads/$ThreadId/messages/$MessageId"

        Invoke-OAIBeta -Uri $url -Method $Method
    }
</code></pre>
</div>
<div class="page" id="RemoveOAIThread">
<h2>Remove-OAIThread</h2>
<p><strong>Page:</strong> 80</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Removes a thread from the OpenAI API.</p>
<h3>Description</h3>
<p>The Remove-OAIThread function removes a thread from the OpenAI API by sending a DELETE request to the specified thread ID.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>threadId</code></td><td>System.Object</td><td>The ID of the thread to be removed.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Remove-OAIThread -threadId "123456789"</code></pre>
<p>This example removes the thread with the ID "123456789" from the OpenAI API.    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param(
        [Parameter(ValueFromPipelineByPropertyName)]
        $threadId
    )

    Process {
        $url = $baseUrl + "/threads/$threadId"
        $Method = 'Delete'

        Invoke-OAIBeta -Uri $url -Method $Method
    }
</code></pre>
</div>
<div class="page" id="RemoveOAIVectorStore">
<h2>Remove-OAIVectorStore</h2>
<p><strong>Page:</strong> 81</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Removes an OAI Vector Store.</p>
<h3>Description</h3>
<p>The Remove-OAIVectorStore function removes an OAI (OpenAI) Vector Store by sending a DELETE request to the specified URI.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>VectorStoreId</code></td><td>System.Object</td><td>The ID of the Vector Store to be removed.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Remove-OAIVectorStore -VectorStoreId "12345"
Removes the OAI Vector Store with the ID "12345".</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param(
        [Parameter(Mandatory, ValueFromPipelineByPropertyName)]
        [Alias('Id')]
        $VectorStoreId
    )

    Process {
        $params = @{
            Uri    = $baseUrl + "/vector_stores/$VectorStoreId"
            Method = 'DELETE'
        }

        Invoke-OAIBeta @params
    }
</code></pre>
</div>
<div class="page" id="RemoveOAIVectorStoreFile">
<h2>Remove-OAIVectorStoreFile</h2>
<p><strong>Page:</strong> 82</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Removes a file from a vector store.</p>
<h3>Description</h3>
<p>The Remove-OAIVectorStoreFile function removes a file from a vector store specified by the VectorStoreId and FileId parameters.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>VectorStoreId</code></td><td>System.Object</td><td>The ID of the vector store from which the file will be removed.</td></tr>
<tr><td><code>FileId</code></td><td>System.Object</td><td>The ID of the file to be removed from the vector store.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Remove-OAIVectorStoreFile -VectorStoreId "12345" -FileId "67890"
Removes the file with ID "67890" from the vector store with ID "12345".</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    param (
        [Parameter(Mandatory)]
        $VectorStoreId,
        [Parameter(Mandatory)]
        $FileId
    )

    $params = @{
        Uri    = $baseUrl + "/vector_stores/$VectorStoreId/files/$FileId"
        Method = "DELETE"
    }

    Invoke-OAIBeta @params
</code></pre>
</div>
<div class="page" id="ResetAIShortCutKey">
<h2>Reset-AIShortCutKey</h2>
<p><strong>Page:</strong> 83</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> 
Reset-AIShortCutKey 
</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
</table>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    $script:messages = @()
</code></pre>
</div>
<div class="page" id="ResetOAIProvider">
<h2>Reset-OAIProvider</h2>
<p><strong>Page:</strong> 84</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Resets the OpenAI provider.</p>
<h3>Description</h3>
<p>The Reset-OAIProvider function is used to reset the OpenAI provider.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Reset-OAIProvider
Resets the OpenAI provider.</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param ()
    
    Set-OAIProvider OpenAI
</code></pre>
</div>
<div class="page" id="SetAzOAISecrets">
<h2>Set-AzOAISecrets</h2>
<p><strong>Page:</strong> 85</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Sets the Azure OAI secrets.</p>
<h3>Description</h3>
<p>This function sets the Azure OAI (OpenAPI Service) secrets by storing the provided values in the script scope.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>apiURI</code></td><td>System.Object</td><td>The URI of the Azure OAI.</td></tr>
<tr><td><code>apiKEY</code></td><td>System.Object</td><td>The API key for accessing the Azure OAI.</td></tr>
<tr><td><code>apiVersion</code></td><td>System.Object</td><td>The version of the Azure OAI.</td></tr>
<tr><td><code>deploymentName</code></td><td>System.Object</td><td>The name of the deployment.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Set-AzOAISecrets -apiURI "https://api.example.com" -apiKEY "myApiKey" -apiVersion "v1" -deploymentName "MyDeployment"
Sets the Azure OAI secrets with the specified values.</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param (
        [Parameter(Mandatory)]
        $apiURI,
        [Parameter(Mandatory)]
        $apiKEY,
        [Parameter(Mandatory)]
        $apiVersion,
        [Parameter(Mandatory)]
        $deploymentName
    )

    $script:AzOAISecrets['apiURI'] = $apiURI
    $script:AzOAISecrets['apiKEY'] = $apiKEY
    $script:AzOAISecrets['apiVersion'] = $apiVersion
    $script:AzOAISecrets['deploymentName'] = $deploymentName
</code></pre>
</div>
<div class="page" id="SetOAIProvider">
<h2>Set-OAIProvider</h2>
<p><strong>Page:</strong> 86</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Sets the provider for OpenAI.</p>
<h3>Description</h3>
<p>The Set-OAIProvider function is used to set the provider for OpenAI. By default, the provider is set to 'OpenAI'.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>Provider</code></td><td>System.Object</td><td>Specifies the provider for OpenAI. The available options are 'AzureOpenAI' and 'OpenAI'.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Set-OAIProvider -Provider 'AzureOpenAI'
This example sets the provider for OpenAI to 'AzureOpenAI'.</code></pre>
<p>    </p>
<pre><code class='language-powershell'>Set-OAIProvider -Provider 'OpenAI'
This example sets the provider for OpenAI to 'OpenAI'.</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param(
        [ValidateSet('AzureOpenAI', 'OpenAI')]
        $Provider = 'OpenAI'
    )

    $script:OAIProvider = $Provider
</code></pre>
</div>
<div class="page" id="ShowOAIAPIReferenceWebPage">
<h2>Show-OAIAPIReferenceWebPage</h2>
<p><strong>Page:</strong> 87</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Opens the OpenAI API reference web page.</p>
<h3>Description</h3>
<p>The Show-OAIAPIReferenceWebPage function opens the OpenAI API reference web page in the default web browser.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Show-OAIAPIReferenceWebPage
Opens the OpenAI API reference web page.</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    Start-Process 'https://platform.openai.com/docs/api-reference'
</code></pre>
</div>
<div class="page" id="ShowOAIAssistantWebPage">
<h2>Show-OAIAssistantWebPage</h2>
<p><strong>Page:</strong> 88</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Opens the OpenAI Playground web page for the specified assistant ID or the default page.</p>
<h3>Description</h3>
<p>The Show-OAIAssistantWebPage function opens the OpenAI Playground web page for the specified assistant ID or the default page if no ID is provided. The web page allows you to interact with the OpenAI assistant.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>assistantId</code></td><td>System.Object</td><td>The ID of the OpenAI assistant. If provided, the function opens the web page for the specified assistant ID. If not provided, the function opens the default web page.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Show-OAIAssistantWebPage -assistantId "assistant-12345"
Opens the OpenAI Playground web page for the assistant with ID "assistant-12345".</code></pre>
<p>    </p>
<pre><code class='language-powershell'>Show-OAIAssistantWebPage
Opens the default OpenAI Playground web page.</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    param(
        [Parameter(ValueFromPipelineByPropertyName)]
        [Alias("id")]
        $assistantId 
    )
    
    Process {

        if ($assistantId) {
            $uri = 'https://platform.openai.com/playground/assistants?assistant={0}' -f $assistantId
        }
        else {
            $uri = 'https://platform.openai.com/playground/assistants'            
        }

        Start-Process $uri
    }
</code></pre>
</div>
<div class="page" id="ShowOAIBilling">
<h2>Show-OAIBilling</h2>
<p><strong>Page:</strong> 89</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Opens the OpenAI platform billing overview page.</p>
<h3>Description</h3>
<p>The Show-OAIBilling function opens the OpenAI platform billing overview page in the default web browser.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Show-OAIBilling
Opens the OpenAI platform billing overview page.</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    Start-Process 'https://platform.openai.com/settings/organization/billing/overview'
</code></pre>
</div>
<div class="page" id="ShowOAIPlaygroundWebPage">
<h2>Show-OAIPlaygroundWebPage</h2>
<p><strong>Page:</strong> 90</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Opens the OpenAI Playground Web Page.</p>
<h3>Description</h3>
<p>This function opens the OpenAI Playground Web Page in the default web browser.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Show-OAIPlaygroundWebPage</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    Start-Process 'https://platform.openai.com/playground'
</code></pre>
</div>
<div class="page" id="ShowOAIVectorStoreWebPage">
<h2>Show-OAIVectorStoreWebPage</h2>
<p><strong>Page:</strong> 91</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Opens the OpenAI Platform Vector Stores page in the default web browser.</p>
<h3>Description</h3>
<p>The Show-OAIVectorStoreWebPage function opens the OpenAI Platform Vector Stores page in the default web browser. If a vector store ID is provided, it opens the specific vector store's page; otherwise, it opens the general vector stores page.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>vectorStoreId</code></td><td>System.Object</td><td>Specifies the ID of the vector store to open. If not provided, the function opens the general vector stores page.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Show-OAIVectorStoreWebPage -vectorStoreId "12345"
Opens the web browser and navigates to the OpenAI Platform Vector Store with ID "12345".</code></pre>
<p>    </p>
<pre><code class='language-powershell'>Show-OAIVectorStoreWebPage
Opens the web browser and navigates to the general OpenAI Platform Vector Stores page.</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    param(
        [Parameter(ValueFromPipelineByPropertyName)]
        [Alias("id")]
        $vectorStoreId 
    )

    if ($vectorStoreId) {
        $uri = 'https://platform.openai.com/storage/vector_stores/{0}' -f $vectorStoreId
    }
    else {
        $uri = 'https://platform.openai.com/storage/vector_stores'
    }

    Start-Process $uri
</code></pre>
</div>
<div class="page" id="StopOAIRun">
<h2>Stop-OAIRun</h2>
<p><strong>Page:</strong> 92</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> 
Stop-OAIRun [-ThreadId] <Object> [-RunId] <Object> [<CommonParameters>]
</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>ThreadId</code></td><td>System.Object</td><td></td></tr>
<tr><td><code>RunId</code></td><td>System.Object</td><td></td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    param(
        [Parameter(Mandatory)]
        $ThreadId,
        [Parameter(Mandatory)]
        $RunId
    )

    $uri = $baseUrl + "/threads/$ThreadId/runs/$RunId/cancel"

    Invoke-OAIBeta -Method POST -Uri $uri
</code></pre>
</div>
<div class="page" id="StopOAIVectorStoreFileBatch">
<h2>Stop-OAIVectorStoreFileBatch</h2>
<p><strong>Page:</strong> 93</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Stops a batch of files in an OpenAI Vector Store.</p>
<h3>Description</h3>
<p>The Stop-OAIVectorStoreFileBatch function is used to stop a batch of files in an OpenAI Vector Store. It cancels the processing of the specified batch of files.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>VectorStoreId</code></td><td>System.Object</td><td>The ID of the Vector Store where the batch of files is located.</td></tr>
<tr><td><code>BatchId</code></td><td>System.Object</td><td>The ID of the batch of files to be stopped.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Stop-OAIVectorStoreFileBatch -VectorStoreId "12345" -BatchId "67890"
Stops the batch of files with ID "67890" in the Vector Store with ID "12345".</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    param (
        [Parameter(Mandatory)]
        $VectorStoreId,
        [Parameter(Mandatory)]
        $BatchId
    )

    $params = @{
        Uri    = $baseUrl + "/vector_stores/$VectorStoreId/file_batches/$BatchId/cancel"
        Method = 'POST'
    }

    Invoke-OAIBeta @params
</code></pre>
</div>
<div class="page" id="SubmitOAIMessage">
<h2>Submit-OAIMessage</h2>
<p><strong>Page:</strong> 94</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Submits an OpenAI message and run.</p>
<h3>Description</h3>
<p>The Submit-OAIMessage function is used to submit an OpenAI message and run. It creates a new message using the New-OAIMessage cmdlet and a new run using the New-OAIRun cmdlet. The function takes three parameters: $Assistant, $Thread, and $UserInput.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>Assistant</code></td><td>System.Object</td><td>The assistant object representing the OpenAI assistant.</td></tr>
<tr><td><code>Thread</code></td><td>System.Object</td><td>The thread object representing the conversation thread.</td></tr>
<tr><td><code>UserInput</code></td><td>System.Object</td><td>The user input to be submitted as a message.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Submit-OAIMessage -Assistant $assistant -Thread $thread -UserInput "Hello, how can I help you?"</code></pre>
<p>This example submits a user message to the OpenAI assistant and creates a new run.    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param(
        $Assistant,
        $Thread,
        $UserInput
    )

    $message = New-OAIMessage -ThreadId $Thread.id -Role user -Content $UserInput
   
    $run = New-OAIRun -ThreadId $Thread.Id -AssistantId $Assistant.Id

    [PSCustomObject]@{
        Run     = $run
        Message = $message
    }
</code></pre>
</div>
<div class="page" id="SubmitOAIToolOutputs">
<h2>Submit-OAIToolOutputs</h2>
<p><strong>Page:</strong> 95</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Submits tool outputs for a specific thread and run.</p>
<h3>Description</h3>
<p>The Submit-OAIToolOutputs function is used to submit tool outputs for a specific thread and run in an application. It sends a POST request to the specified URL with the provided tool outputs.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>ThreadId</code></td><td>System.Object</td><td>The ID of the thread for which the tool outputs are being submitted.</td></tr>
<tr><td><code>RunId</code></td><td>System.Object</td><td>The ID of the run for which the tool outputs are being submitted.</td></tr>
<tr><td><code>ToolOutputs</code></td><td>System.Object</td><td>The tool outputs to be submitted. This parameter should be an object containing the tool outputs.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Submit-OAIToolOutputs -threadId 123 -runId 456 -toolOutputs $outputs</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param(
        [Parameter(Mandatory)]
        $ThreadId,
        [Parameter(Mandatory)]
        $RunId,
        [Parameter(Mandatory)]
        $ToolOutputs
    )

    $url = $baseUrl + "/threads/$ThreadId/runs/$RunId/submit_tool_outputs"
    $Method = 'Post'

    $body = @{
        tool_outputs = $ToolOutputs
    }

    Invoke-OAIBeta -Uri $url -Method $Method -Body $body
</code></pre>
</div>
<div class="page" id="TestJsonReplacement">
<h2>Test-JsonReplacement</h2>
<p><strong>Page:</strong> 96</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> This function tests if a given JSON string is valid by attempting to convert it using ConvertFrom-Json cmdlet.</p>
<h3>Description</h3>
<p>The Test-JsonReplacement function takes a JSON string as input and attempts to convert it using the ConvertFrom-Json cmdlet. If the conversion is successful, it returns $true; otherwise, it returns $false.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>JSON</code></td><td>System.Object</td><td>Specifies the JSON string to be tested.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Test-JsonReplacement -JSON '{"name": "John", "age": 30, "city": "New York"}'
This example tests the validity of the given JSON string.</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param(
        [Parameter(Mandatory)]
        $JSON
    )

    Write-Verbose "Using ConvertFrom-Json"
    try {
        ConvertFrom-Json -InputObject $Json | Out-Null
        $true
    }
    catch {
        $false
    }

</code></pre>
</div>
<div class="page" id="TestLLMModel">
<h2>Test-LLMModel</h2>
<p><strong>Page:</strong> 97</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Tests the LLM model.</p>
<h3>Description</h3>
<p>This function tests the LLM model by checking if the specified model is valid based on the provider.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
</table>
<h3>Source Code</h3>
<pre><code class='language-powershell'>    
    $provider = Get-OAIProvider
    if ($provider -eq 'OpenAI') {
        $modelList = 'gpt-4', 'gpt-3.5-turbo', 'gpt-3.5-turbo-16k', 'gpt-4-turbo-preview', 'gpt-4-1106-preview', 'gpt-3.5-turbo-1106'
        if ($_ -in $modelList) {
            $true
        }
        else {
            throw 'Invalid model. Valid models are: ' + $modelList
        }
    }
    elseif ($provider -eq 'AzureOpenAI') {
        $true
    }
</code></pre>
</div>
<div class="page" id="TestOAIAssistantId">
<h2>Test-OAIAssistantId</h2>
<p><strong>Page:</strong> 98</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Tests whether an OpenAI Assistant ID exists.</p>
<h3>Description</h3>
<p>The Test-OAIAssistantId function checks whether an OpenAI Assistant ID exists by querying the Get-OAIAssistantItem cmdlet.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>AssistantId</code></td><td>System.Object</td><td>The Assistant ID to be tested.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Test-OAIAssistantId -AssistantId "12345678"
Checks whether the Assistant ID "12345678" exists.</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param(
        [Parameter(ValueFromPipelineByPropertyName)]
        [Alias("id")]
        $AssistantId
    )

    Process {

        $result = Get-OAIAssistantItem -AssistantId $AssistantId -ErrorAction SilentlyContinue
        if ($null -eq $result) {
            return $false                
        }

        return $true
    }
</code></pre>
</div>
<div class="page" id="UpdateOAIAssistant">
<h2>Update-OAIAssistant</h2>
<p><strong>Page:</strong> 99</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Updates an OpenAI Assistant.</p>
<h3>Description</h3>
<p>This function updates an OpenAI Assistant with the specified parameters.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>Id</code></td><td>System.Object</td><td>The ID of the OpenAI Assistant to update.</td></tr>
<tr><td><code>Model</code></td><td>System.Object</td><td>The model to use for the OpenAI Assistant.</td></tr>
<tr><td><code>Name</code></td><td>System.Object</td><td>The name of the OpenAI Assistant.</td></tr>
<tr><td><code>Description</code></td><td>System.Object</td><td>The description of the OpenAI Assistant.</td></tr>
<tr><td><code>Instructions</code></td><td>System.Object</td><td>The instructions for using the OpenAI Assistant.</td></tr>
<tr><td><code>Tools</code></td><td>System.Object</td><td>The tools required for using the OpenAI Assistant.</td></tr>
<tr><td><code>ToolResources</code></td><td>System.Object</td><td></td></tr>
<tr><td><code>Metadata</code></td><td>System.Object</td><td>The metadata for the OpenAI Assistant.</td></tr>
<tr><td><code>Temperature</code></td><td>System.Object</td><td></td></tr>
<tr><td><code>TopP</code></td><td>System.Object</td><td></td></tr>
<tr><td><code>ResponseFormat</code></td><td>System.Object</td><td></td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Update-OAIAssistant -Id "assistant123" -Model "gpt-3.5-turbo" -Name "My Assistant" -Description "This is my assistant" -Instructions "Use this assistant to perform various tasks" -Tools "PowerShell", "Visual Studio Code" -FileIds "file1", "file2" -Metadata @{ "key1" = "value1"; "key2" = "value2" }</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param(
        [Parameter(ValueFromPipelineByPropertyName)]
        $Id,
        $Model,
        $Name,
        $Description,
        $Instructions,        
        $Tools,  
        $ToolResources,
        $Metadata,
        [ValidateScript({ $_ -ge 0 -and $_ -le 2 })]
        $Temperature = $null,
        [ValidateScript({ $_ -ge 0 -and $_ -le 1 })]
        $TopP = $null,
        [ValidateSet('auto', 'json', 'text')]
        $ResponseFormat = 'auto'
    )

    Process {
        $url = $baseUrl + "/assistants/$Id"
        $Method = 'Post'

        $body = @{}

        if ($Model) {
            $body['model'] = $Model
        }
        if ($Name) {
            $body['name'] = $Name
        }
        if ($Description) {
            $body['description'] = $Description
        }
        if ($Instructions) {
            $body['instructions'] = $Instructions
        }

        if ($Tools) {
            $body['tools'] = @($Tools)
        }

        if ($FileIds) {
            $body['file_ids'] = @($FileIds)
        }
        if ($Metadata) {
            $body['metadata'] = $Metadata
        }

        Invoke-OAIBeta -Uri $url -Method $Method -Body $body
    }
</code></pre>
</div>
<div class="page" id="UpdateOAIMessage">
<h2>Update-OAIMessage</h2>
<p><strong>Page:</strong> 100</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Updates an OAI message by sending a POST request to the specified thread and message IDs.</p>
<h3>Description</h3>
<p>The Update-OAIMessage function updates an OAI message by sending a POST request to the specified thread and message IDs. It allows you to update the metadata of a message.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>ThreadId</code></td><td>System.Object</td><td>The ID of the thread to which the message belongs. This parameter is also aliased as 'thread_id'.</td></tr>
<tr><td><code>MessageId</code></td><td>System.Object</td><td>The ID of the message to be updated. This parameter is also aliased as 'id'.</td></tr>
<tr><td><code>Metadata</code></td><td>System.Object</td><td>Optional. The updated metadata for the message.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Update-OAIMessage -ThreadId 1234 -MessageId 5678 -Metadata @{ "key" = "value" }
Updates the message with ID 5678 in the thread with ID 1234, setting the metadata to {"key": "value"}.</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    param(
        [Parameter(ValueFromPipelineByPropertyName)]
        [Alias('thread_id')]        
        $ThreadId,
        [Parameter(ValueFromPipelineByPropertyName)]
        [Alias('id')]
        $MessageId,
        $Metadata
    )

    Process {

        if ($null -eq $ThreadId -or $null -eq $MessageId) {
            return
        }

        $Method = 'Post'
        $url = $baseUrl + "/threads/$ThreadId/messages/$MessageId"

        $body = @{}
        if ($null -ne $Metadata) {
            $body.metadata = $Metadata
        }

        Invoke-OAIBeta -Uri $url -Method $Method -Body $body
    }
</code></pre>
</div>
<div class="page" id="UpdateOAIRun">
<h2>Update-OAIRun</h2>
<p><strong>Page:</strong> 101</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> 
Update-OAIRun [[-ThreadId] <Object>] [[-RunId] <Object>] [[-Metadata] <Object>] [<CommonParameters>]
</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>ThreadId</code></td><td>System.Object</td><td></td></tr>
<tr><td><code>RunId</code></td><td>System.Object</td><td></td></tr>
<tr><td><code>Metadata</code></td><td>System.Object</td><td></td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param(
        [Parameter(ValueFromPipelineByPropertyName)]
        [Alias('thread_id')]        
        $ThreadId,
        [Parameter(ValueFromPipelineByPropertyName)]
        [Alias('run_id')]
        $RunId,
        $Metadata
    )

    Process {
        if ($null -eq $ThreadId -or $null -eq $RunId) {
            return
        }

        $url = $baseUrl + "/threads/$ThreadId/runs/$RunId"
        $Method = 'Post'

        $body = @{}
        if ($Metadata) {
            $body['metadata'] = $Metadata
        }

        Invoke-OAIBeta -Uri $url -Method $Method -Body $body
    }
</code></pre>
</div>
<div class="page" id="UpdateOAIThread">
<h2>Update-OAIThread</h2>
<p><strong>Page:</strong> 102</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Updates an OAI thread with the specified thread ID, tool resources, and metadata.</p>
<h3>Description</h3>
<p>The Update-OAIThread function is used to update an OAI (OpenAI) thread with the specified thread ID, tool resources, and metadata. It sends a POST request to the specified URL with the provided data.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>threadId</code></td><td>System.Object</td><td>The ID of the thread to be updated. This parameter is mandatory.</td></tr>
<tr><td><code>toolResources</code></td><td>System.Object</td><td>The tool resources to be associated with the thread.</td></tr>
<tr><td><code>metadata</code></td><td>System.Object</td><td>The metadata to be associated with the thread.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Update-OAIThread -threadId "12345" -toolResources "resource1, resource2" -metadata "key1=value1, key2=value2"</code></pre>
<p>This example updates the OAI thread with the ID "12345" by associating it with the tool resources "resource1" and "resource2", and the metadata "key1=value1" and "key2=value2".    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param (
        [Parameter(Mandatory)]
        $threadId,
        $toolResources,
        $metadata
    )

    $url = $baseUrl + '/threads/' + $threadId
    $Method = 'Post'

    $body = @{
        tool_resources = $toolResources
        metadata       = $metadata
    }

    Invoke-OAIBeta -Uri $url -Method $Method -Body $body
</code></pre>
</div>
<div class="page" id="UpdateOAIVectorStore">
<h2>Update-OAIVectorStore</h2>
<p><strong>Page:</strong> 103</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Updates an OAI Vector Store.</p>
<h3>Description</h3>
<p>The Update-OAIVectorStore function is used to update an OAI Vector Store with the specified parameters.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>VectorStoreId</code></td><td>System.Object</td><td>The ID of the Vector Store to update.</td></tr>
<tr><td><code>Name</code></td><td>System.Object</td><td>The new name for the Vector Store.</td></tr>
<tr><td><code>ExpiresAfter</code></td><td>System.Object</td><td>A hashtable specifying the expiration time for the Vector Store. The hashtable should contain the following keys:
- 'anchor': The anchor date and time.
- 'day': The number of days after the anchor date.</td></tr>
<tr><td><code>Metadata</code></td><td>System.Object</td><td>A hashtable containing additional metadata for the Vector Store.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>Update-OAIVectorStore -VectorStoreId "12345" -Name "New Vector Store" -ExpiresAfter @{ 'anchor' = '2022-12-31T00:00:00Z'; 'day' = 30 } -Metadata @{ 'key' = 'value' }</code></pre>
<p>This example updates the Vector Store with ID "12345" by changing its name to "New Vector Store", setting an expiration time of 30 days after December 31, 2022, and adding a metadata key-value pair.    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param (
        [Parameter(Mandatory)]
        $VectorStoreId,
        $Name,
        $ExpiresAfter,
        $Metadata
    )

    $body = @{}

    if ($Name) {
        $body.name = $Name
    }

    if ($ExpiresAfter) {
        $body.expires_after = $ExpiresAfter
    }

    if ($Metadata) {
        $body.metadata = $Metadata
    }

    $params = @{
        Uri    = $baseUrl + "/vector_stores/$VectorStoreId"
        Method = 'POST'
        body   = $body
    }

    Invoke-OAIBeta @params
</code></pre>
</div>
<div class="page" id="WaitOAIOnRun">
<h2>Wait-OAIOnRun</h2>
<p><strong>Page:</strong> 104</p>
<p><strong>Type:</strong> Function</p><p><strong>Synopsis:</strong> Waits for a run to complete in an Azure Machine Learning service workspace.</p>
<h3>Description</h3>
<p>The Wait-OAIOnRun function waits for a run to complete in an Azure Machine Learning service workspace. It continuously checks the status of the run and sleeps for a short duration until the run is no longer in the 'queued' or 'in_progress' state.</p>
<h3>Parameters</h3>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td><code>Run</code></td><td>System.Object</td><td>The run object representing the run to wait for.</td></tr>
<tr><td><code>Thread</code></td><td>System.Object</td><td>The thread object representing the thread associated with the run.</td></tr>
<tr><td><code>Verbose</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>Debug</code></td><td>System.Management.Automation.SwitchParameter</td><td></td></tr>
<tr><td><code>ErrorAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>WarningAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>InformationAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ProgressAction</code></td><td>System.Management.Automation.ActionPreference</td><td></td></tr>
<tr><td><code>ErrorVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>WarningVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>InformationVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutVariable</code></td><td>System.String</td><td></td></tr>
<tr><td><code>OutBuffer</code></td><td>System.Int32</td><td></td></tr>
<tr><td><code>PipelineVariable</code></td><td>System.String</td><td></td></tr>
</table>
<h3>Examples</h3>
<pre><code class='language-powershell'>$run = Get-OAIRunItem -ThreadId $thread.id -RunId $run.id
Wait-OAIOnRun -Run $run -Thread $thread</code></pre>
<p>    </p>
<h3>Source Code</h3>
<pre><code class='language-powershell'>
    [CmdletBinding()]
    param(
        $Run,
        $Thread
    )

    Write-Verbose "[$(Get-Date)] Waiting for run to complete..."
    while ($Run.status -eq 'queued' -or $Run.status -eq 'in_progress') {
        $Run = Get-OAIRunItem -ThreadId $Thread.id -RunId $Run.id
        Start-Sleep -Seconds 0.5
    }
    
    $Run
</code></pre>
</div>
</div>
</body>
</html>
